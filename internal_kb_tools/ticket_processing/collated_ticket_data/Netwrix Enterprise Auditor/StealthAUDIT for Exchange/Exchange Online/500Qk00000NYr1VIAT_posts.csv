"Id","ParentId","Type","CreatedById","CreatedDate","Body","Title","LinkUrl","RelatedRecordId","InsertedById","LastModifiedDate"
"0D5Qk00000anwDAKAY","500Qk00000NYr1VIAT","TextPost","0054u000008ARZjAAO","2025-04-01T14:18:36.000Z","Description: Hello, 

It has been requested that we build a report that contains message tracking for distribution groups (how many emails were sent to our dlists for a specific period of time). I found the below 2 tables, but neither are accurately reflecting how many emails our dlists actually received. Need some help on this one. Thanks

SA_RS_DLCountReceived_Last30days_EXO 
SA_RS_DLCountReceived_Last180days_EXO","","","","0054u000008ARZjAAO","2025-04-01T14:18:36.000Z"
"0D5Qk00000aukeWKAQ","500Qk00000NYr1VIAT","TextPost","00570000003KXurAAG","2025-04-02T21:20:09.000Z","Invitation updated. Attendees: Dusty Grayson","","","","00570000003KXurAAG","2025-04-02T21:20:09.000Z"
"0D5Qk00000autRhKAI","500Qk00000NYr1VIAT","TextPost","00570000003KXurAAG","2025-04-02T21:20:09.000Z","Invitation updated. Attendees: Dusty Grayson, Lenny Jones","","","","00570000003KXurAAG","2025-04-02T21:20:09.000Z"
"0D5Qk00000aukeVKAQ","500Qk00000NYr1VIAT","TextPost","00570000003KXurAAG","2025-04-02T21:20:09.000Z","Invitation updated. Attendees: No attendees listed","","","","00570000003KXurAAG","2025-04-02T21:20:09.000Z"
"0D5Qk00000bW1SlKAK","500Qk00000NYr1VIAT","TextPost","00570000003KXurAAG","2025-04-10T18:33:39.000Z","<p>Maximum results count imposed by Exchange reached at 1000000 records</p>","","","","00570000003KXurAAG","2025-04-10T18:33:39.000Z"
"0D5Qk00000bW4X9KAK","500Qk00000NYr1VIAT","TextPost","00570000003KXurAAG","2025-04-10T19:08:13.000Z","<p># Gets a list of modules on the computer that were installed by PowerShellGet.</p><p>Get-InstalledModule -Name ExchangeOnlineManagement |Select-Object Version, Name, Repository, InstalledLocation </p><p>Get-InstalledModule -Name Microsoft.Graph |Select-Object Version, Name, Repository, InstalledLocation</p><p> </p><p> </p><p>We see the Current modules </p><p>ExchangeOnlineManagement           <b>3.7.2</b></p><p>Microsoft.Graph                               <b> 2.24.0</b> </p><p> </p><p> </p><p>03/04/2025 03:00:14 DEBUG          StealthAUDIT(TDispatch)           TDispatch.StartHostDiscovery         &quot;Retrieving hosts from EXCHANGE ONLINE - done&quot;                               -1        8780   10548</p><p>03/04/2025 03:00:14 DEBUG          StealthAUDIT(TDispatch)           TDispatch.AddHost   &quot;<a href=""https://PS.OUTLOOK.COM"" alt=""https://PS.OUTLOOK.COM"" target=""_blank"">PS.OUTLOOK.COM</a>&quot;                                  -1           8780   10548</p><p>03/04/2025 03:00:14 DEBUG          StealthAUDIT TConnectionMgr.PrepareHost           &quot;<a href=""https://PS.OUTLOOK.COM"" alt=""https://PS.OUTLOOK.COM"" target=""_blank"">PS.OUTLOOK.COM</a>&quot;                                  -1        8780   10548</p><p>03/04/2025 03:00:14 INFO  StealthAUDIT TConnectionMgr.PrepareHost           &quot;Added <a href=""https://PS.OUTLOOK.COM"" alt=""https://PS.OUTLOOK.COM"" target=""_blank"">PS.OUTLOOK.COM</a>&quot;                                  -1        8780   10548</p><p>03/04/2025 03:00:14 INFO  StealthAUDIT(TDispatch)    TDispatch.AddHost           &quot;Preparing host: <a href=""https://PS.OUTLOOK.COM"" alt=""https://PS.OUTLOOK.COM"" target=""_blank"">PS.OUTLOOK.COM</a> job connection profile: EXO Scan Account list profile: EXO Scan Account&quot;                             -1        8780   10548</p><p>^^^^^</p><p> </p><p> </p><p>03/04/2025 03:42:03 WARNING    EXCHANGEPS         ExecuteScript &quot;Maximum results count imposed by Exchange reached at 1000000 records&quot;           <a href=""https://PS.OUTLOOK.COM"" alt=""https://PS.OUTLOOK.COM"" target=""_blank"">PS.OUTLOOK.COM</a> DCExtract      2672   8780   10548</p><p> </p><p> </p><p>03/04/2025 03:42:15 ERROR          EXCHANGEPS         ExecuteScript &quot; &#39;Microsoft.PowerShell.Commands.PowerShellGet.Telemetry&#39; error: Unable to find type [Microsoft.PowerShell.Commands.PowerShellGet.Telemetry].&quot;           <a href=""https://PS.OUTLOOK.COM"" alt=""https://PS.OUTLOOK.COM"" target=""_blank"">PS.OUTLOOK.COM</a> DCExtract      2672   8780   10548</p><p>^^^^^</p><p> 03/04/2025 03:42:15 ERROR          EXCHANGEPS         ExecuteScript &quot; &#39;Microsoft.PowerShell.Commands.PowerShellGet.Telemetry&#39; error: Unable to find type [Microsoft.PowerShell.Commands.PowerShellGet.Telemetry].&quot;           <a href=""https://PS.OUTLOOK.COM"" alt=""https://PS.OUTLOOK.COM"" target=""_blank"">PS.OUTLOOK.COM</a> DCExtract      2672   8780   10548</p><p>^^^^</p><p> 03/04/2025 03:42:15                   DEBUG    TSPADOEngineTransportItf.DebugLog                                                     TSPEngineTransportItf.PrepareForTable &quot;Start&quot;                                                     <a href=""https://PS.OUTLOOK.COM"" alt=""https://PS.OUTLOOK.COM"" target=""_blank"">PS.OUTLOOK.COM</a>                   2672   8780                                                     10548</p><p>03/04/2025 03:42:15                   DEBUG    TSPADOEngineTransportItf.DebugLog                                                     TSPEngineTransportItf.PrepareForTable &quot;End&quot;                                                     <a href=""https://PS.OUTLOOK.COM"" alt=""https://PS.OUTLOOK.COM"" target=""_blank"">PS.OUTLOOK.COM</a>       LocalDomains 2672                                                     8780         10548</p><p>03/04/2025 03:42:15                   DEBUG    SPFILE                                                     TSPHostDBEngine.ParseAndCommitHostRow()                                                     &quot;Processing row: 0&quot;         <a href=""https://PS.OUTLOOK.COM"" alt=""https://PS.OUTLOOK.COM"" target=""_blank"">PS.OUTLOOK.COM</a>                                                     LocalDomains      2672   8780   10548</p><p> </p>","","","","00570000003KXurAAG","2025-04-10T19:08:13.000Z"
"0D5Qk00000bWIiEKAW","500Qk00000NYr1VIAT","TextPost","00570000003KXurAAG","2025-04-10T20:15:31.000Z","<p>Another possible issue:</p><p> </p><p>Exchange Online Host List</p><p>Exchange Online requires a custom host list. The host list should include the tenant name of the Microsoft Entra tenant used to connect to Exchange Online.</p><ul><li>The host name must be the domain name of the tenant, for example </li><li><b>company.onmicrosoft.com</b></li><li>. See the <a href=""https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/Config/ExchangeOnline/Access.htm#Identify"" alt=""https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/Config/ExchangeOnline/Access.htm#Identify"" target=""_blank"">Identify the Tenant&#39;s Name</a> topic for additional information.</li></ul><p> </p>","","","","00570000003KXurAAG","2025-04-10T20:15:31.000Z"
"0D5Qk00000bWVQrKAO","500Qk00000NYr1VIAT","TextPost","00570000003KXurAAG","2025-04-10T20:49:06.000Z","Steps to Reproduce Updated: Another possible issue:  Exchange Online Host List
Exchange Online requires a custom host list. The host list should include the tenant name of the Microsoft Entra tenant used to connect to Exchange Online.

The host name must be the domain name of the tenant, for example 
company.onmicrosoft.com

We are currently pointintg to the old  PS.OUTLOOK.COM","","","","00570000003KXurAAG","2025-04-10T20:49:06.000Z"
"0D5Qk00000bWXjaKAG","500Qk00000NYr1VIAT","TextPost","00570000003KXurAAG","2025-04-10T20:49:27.000Z","What We've Learned Updated: The host name must be the domain name of the tenant, for example 
company.onmicrosoft.com

We are currently pointintg to the old  PS.OUTLOOK.COM","","","","00570000003KXurAAG","2025-04-10T20:49:27.000Z"
"0D5Qk00000bWUIuKAO","500Qk00000NYr1VIAT","TextPost","00570000003KXurAAG","2025-04-10T20:49:40.000Z","Next Steps Updated: Pending update ticket.","","","","00570000003KXurAAG","2025-04-10T20:49:40.000Z"
"0D5Qk00000bud3nKAA","500Qk00000NYr1VIAT","TextPost","00570000003KXurAAG","2025-04-15T20:52:09.000Z","<p><a href=""https://teams.microsoft.com/l/message/19:bfc03607c1094e528b56f819d6ec30cf@thread.tacv2/1744750292914?tenantId=097499ff-179d-4959-ab02-86d364125bfc&amp;groupId=72f83b71-3180-482b-b588-9595342c5a50&amp;parentMessageId=1744750292914&amp;teamName=SWAT%20Teams%3A%20Product%20Discussions%2C%20PM%20Q%26A%2C%20Feedback&amp;channelName=NAA%20DAG&amp;createdTime=1744750292914"" alt=""https://teams.microsoft.com/l/message/19:bfc03607c1094e528b56f819d6ec30cf@thread.tacv2/1744750292914?tenantId=097499ff-179d-4959-ab02-86d364125bfc&amp;groupId=72f83b71-3180-482b-b588-9595342c5a50&amp;parentMessageId=1744750292914&amp;teamName=SWAT%20Teams%3A%20Product%20Discussions%2C%20PM%20Q%26A%2C%20Feedback&amp;channelName=NAA%20DAG&amp;createdTime=1744750292914"" target=""_blank"">Dusty Grayson: Exchange Online ERROR related to PowerShellGet.Telemetry.</a></p><p> posted in SWAT Teams: Product Discussions, PM Q&amp;A, Feedback / NAA DAG on Tuesday, April 15, 2025 4:51 PM</p><p> <a href=""https://teams.microsoft.com/l/message/19:bfc03607c1094e528b56f819d6ec30cf@thread.tacv2/1744750292914?tenantId=097499ff-179d-4959-ab02-86d364125bfc&amp;groupId=72f83b71-3180-482b-b588-9595342c5a50&amp;parentMessageId=1744750292914&amp;teamName=SWAT%20Teams%3A%20Product%20Discussions%2C%20PM%20Q%26A%2C%20Feedback&amp;channelName=NAA%20DAG&amp;createdTime=1744750292914"" alt=""https://teams.microsoft.com/l/message/19:bfc03607c1094e528b56f819d6ec30cf@thread.tacv2/1744750292914?tenantId=097499ff-179d-4959-ab02-86d364125bfc&amp;groupId=72f83b71-3180-482b-b588-9595342c5a50&amp;parentMessageId=1744750292914&amp;teamName=SWAT%20Teams%3A%20Product%20Discussions%2C%20PM%20Q%26A%2C%20Feedback&amp;channelName=NAA%20DAG&amp;createdTime=1744750292914"" target=""_blank"">https://teams.microsoft.com/l/message/19:bfc03607c1094e528b56f819d6ec30cf@thread.tacv2/1744750292914?tenantId=097499ff-179d-4959-ab02-86d364125bfc&amp;groupId=72f83b71-3180-482b-b588-9595342c5a50&amp;parentMessageId=1744750292914&amp;teamName=SWAT%20Teams%3A%20Product%20Discussions%2C%20PM%20Q%26A%2C%20Feedback&amp;channelName=NAA%20DAG&amp;createdTime=1744750292914</a></p>","","","","00570000003KXurAAG","2025-04-15T20:52:09.000Z"
"0D5Qk00000buYyyKAE","500Qk00000NYr1VIAT","TextPost","00570000003KXurAAG","2025-04-15T21:30:03.000Z","What We've Learned Updated: The host name must be the domain name of the tenant, for example 
company.onmicrosoft.com

We are currently pointing to the old  PS.OUTLOOK.COM

Confirmed that there is data in the Netwrix Access Analyzer (NAA) formally Netwrix Enterprise Auditor (NEA) formally StealthAUDIT (SA) EX_Mailflow_DL tables (SA_EX_MailFlow_DL_AzureMemberCount & SA_EX_MailFlow_DLsByCount)

Looking at the data within SQL Server Management Studio (SSMS) for the ReceivedCount we switched this to DESC from asc

Populating the SA_RS_DLCountReceived_Last30days_EXO and SA_RS_DLCountReceived_Last180days_EXO tables.
EXAMPLE:
IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SA_RS_DLCountReceived_Last180days_EXO]') AND type in (N'U'))
  DROP TABLE [SA_RS_DLCountReceived_Last180days_EXO]

SELECT
            DISTINCT RecipientAddress AS RecipientAddress,
            RecipientDepartment as DL,
            ISNULL(COUNT(*),0) AS ReceivedCount
INTO
            SA_RS_DLCountReceived_Last180days_EXO
FROM
            SA_EX_MailFlow_History
WHERE
            RecipientType = 'Distribution List' and [Date] > GETDATE()-180  --SAME for the -30 query
GROUP BY
            RecipientAddress,
            RecipientDepartment
            Order by ReceivedCount DESC -- WAS asc

Adjusted the Schedule task to run Entra ID Inventory @3am and the full  Exchange >> 8. Exchange Online group starting @4am

Set the Report this jobs creates to email to you as a CSV once completed.

Disabling the child jobs to mitigate conflict.","","","","00570000003KXurAAG","2025-04-15T21:30:03.000Z"
"0D5Qk00000cNY3bKAG","500Qk00000NYr1VIAT","TextPost","00570000003KXurAAG","2025-04-22T13:07:54.000Z","<p>Looking at a similar ticket <a href=""https://nwxcorp.lightning.force.com/lightning/r/Case/500Qk000007w2wfIAA/view"" alt=""https://nwxcorp.lightning.force.com/lightning/r/Case/500Qk000007w2wfIAA/view"" target=""_blank"">00397627 </a> pointed to the following:</p><p> </p><p> Install-Module -Name <b>PowerShellGet</b> -Force</p><p>Install-PackageProvider -Name NuGet -Force</p><p>Install-Module -Name Az.Accounts -Force</p><p><b>Reference:</b></p><p><a href=""https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA0Qk0000001i3pKAA.html"" alt=""https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA0Qk0000001i3pKAA.html"" target=""_blank"">PowerShell Modules Required for O365 Configuration in NEA</a></p><p>  <a href=""https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA0Qk0000001i3pKAA.html"" alt=""https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA0Qk0000001i3pKAA.html"" target=""_blank"">https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA0Qk0000001i3pKAA.html</a> </p><p>&amp;</p><p><a href=""https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u00000111IrCAI.html"" alt=""https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u00000111IrCAI.html"" target=""_blank"">System.Exception − New-ExoPSSession PowerShell Error in Netwrix StealthAUDIT</a></p><p>   <a href=""https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u00000111IrCAI.html"" alt=""https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u00000111IrCAI.html"" target=""_blank"">https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u00000111IrCAI.html</a> </p><p> </p><p>Will also want to reconfirm the Exchange <b>Online roles</b> for ExchangePS</p><p>    <a href=""https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Requirements/Target/ExchangeOnline.htm"" alt=""https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Requirements/Target/ExchangeOnline.htm"" target=""_blank"">https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Requirements/Target/ExchangeOnline.htm</a></p>","","","","00570000003KXurAAG","2025-04-22T13:07:54.000Z"
"0D5Qk00000cOWkWKAW","500Qk00000NYr1VIAT","TextPost","00570000003KXurAAG","2025-04-22T14:51:04.000Z","Invitation updated. Attendees: Dusty Grayson, Tay Caliguiri","","","","00570000003KXurAAG","2025-04-22T14:51:04.000Z"
"0D5Qk00000cOWkXKAW","500Qk00000NYr1VIAT","TextPost","00570000003KXurAAG","2025-04-22T14:51:05.000Z","Invitation updated. Attendees: Dusty Grayson, Tay Caliguiri, Lenny Jones","","","","00570000003KXurAAG","2025-04-22T14:51:05.000Z"
"0D5Qk00000cYkvkKAC","500Qk00000NYr1VIAT","TextPost","0054u000007MiY9AAK","2025-04-24T19:45:30.000Z","Next Steps Updated: We ran PowerShell Install-Module -Name PowerShellGet -Force manually from PowerShell and are now waiting on the job to complete, but the error is no longer in the logs where it previously was.","","","","0054u000007MiY9AAK","2025-04-24T19:45:30.000Z"
"0D5Qk00000cYu5EKAS","500Qk00000NYr1VIAT","TextPost","0054u000007MiY9AAK","2025-04-24T19:46:01.000Z","What We've Learned Updated: We were receiving the following error with a few minutes of the Exchange Online Mailflow Collection job kicking off:
'Microsoft.PowerShell.Commands.PowerShellGet.Telemetry' error: Unable to find type [Microsoft.PowerShell.Commands.PowerShellGet.Telemetry]

In PowerShell Admin we ran Get-Module -ListAvailable⁠ and noticed the current PowerShellGet version was 1.0.0.1 which tells me that even though we are trying to install/upgrade to a newer version of PowerShellGet in the Exchange script, it is failing.","","","","0054u000007MiY9AAK","2025-04-24T19:46:01.000Z"
"0D5Qk00000cYdkpKAC","500Qk00000NYr1VIAT","TextPost","0054u000007MiY9AAK","2025-04-24T19:46:55.000Z","<p>Attached this doc to the ticket: <a href=""https://nwxcorp.lightning.force.com/lightning/r/General__kav/ka0Qk000000BKxtIAG/view"" alt=""https://nwxcorp.lightning.force.com/lightning/r/General__kav/ka0Qk000000BKxtIAG/view"" target=""_blank"">PowerShell Modules Required for O365 Configuration in NEA</a></p>","","","","0054u000007MiY9AAK","2025-04-24T19:46:55.000Z"
