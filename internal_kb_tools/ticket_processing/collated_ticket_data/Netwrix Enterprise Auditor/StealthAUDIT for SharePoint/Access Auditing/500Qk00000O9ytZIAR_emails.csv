"Id","ParentId","CreatedDate","LastModifiedDate","TextBody","Subject","FromAddress","FromName","ToAddress","CcAddress","BccAddress","HasAttachment","MessageDate","IsExternallyVisible"
"02sQk00000NqjdJIAR","500Qk00000O9ytZIAR","2025-04-17T13:59:48.000Z","2025-04-17T14:03:30.000Z","ref:_00D7091pB._500Q000O9ytZ:ref

Dear Netwrix Support, 

 Thank you for reaching out to us. This email is to confirm that we have received your request, and a ticket has been created. 

 This is the information we've received from you: 
Dear Liam Rice,

Thank you for contacting us! We're writing to let you know we've received your Support request! Everyone here at Netwrix appreciates you taking the time to bring your comments, issues or suggestions to our attention. Each customer inquiry helps improve our products and services and ensures that we are meeting your needs.

Feel confident that a Netwrix team member will respond to you as soon as possible. The good news is that we use real Netwrix employees to respond to you personally. Because we put extra attention into every customer support question, we respond within the time specified in your Service Level Agreement.  Please refer to the Support Reference Guide for further information on our SLA which can be found here: https://www.netwrix.com/download/documents/Customer_Support_Reference_Guide.pdf

To provide us with additional details or updates, you can simply reply to this message via email. Please be sure to leave the subject and body of this email in place.

Ticket number: 00442427

Thanks again!

The Netwrix Support Team

www.netwrix.com | Twitter: @netwrix


ref:_00D7000000091pB._500Qk00000O9ytZ:ref

________________________________

Please be aware that emails sent between organisations are not always secure. Please therefore do not enclose identifiable patient information if replying to this email.
 

 If you need to add any additional information, images or documents to your ticket, please include them in response to this email now.  

 Our team is now aware of your concern and will review it as soon as possible. We appreciate your patience, and we'll keep you updated on our progress. 

 You can find many helpful guides by going onto Teams > Organisational Information > IT Guides. 

 Thank you for your patience. 

 Sincerely, 

 St Margaret's Hospice IT Services Team","Ticket Received - Netwrix Support Ticket #00442427 - RegisterAzureAppAuth - ref:_00D7000000091pB._500Qk00000O9ytZ:ref","support@smhtechnicalservices.freshdesk.com","St Margarets Hospice","techsupport@netwrix.com","","","false","2025-04-17T13:59:40.000Z","true"
"02sQk00000NqrZJIAZ","500Qk00000O9ytZIAR","2025-04-17T15:10:47.000Z","2025-04-17T15:10:47.000Z","Hi Liam, 

Thank you for contacting Netwrix Technical Support.
My name is Artem, I will be assisting you with this ticket.

Thank you for sharing this information. To make sure I understand issue at hand correctly and to streamline our troubleshooting, please, provide additional information from your side:


	Currently you are trying to set up a SharePoint Online Access Auditing. Correct?
	Is this a new configuration for your Netwrix Access Analyzer or was it configured before?
	You tried using automatic configuration of SharePoint Online application. Is that correct?


Based on the error message you shared it looks like the issue is caused due to missing permissions for Graph API on the registered application in Entra ID for SharePoint online Access Auditing.

I would like to suggest configuring application and connection profiles for SharePoint online access auditing manually.
It is recommended to start from the beginning and configure application as described in these steps:

To configure application for SharePoint Online access auditing follow these steps from the top of the article:
https://helpcenter.netwrix.com/bundle/AccessAnalyzer_12.0/page/Content/Config/SharePointOnline/Access.htm

Once you have SharePoint Online application set up and once you copy all necessary information (The comma delimited string containing the path to the certificate PFX file, certificate password, and the Microsoft Entra ID environment identifier ( CertPath,CertPassword,AzureEnvironment)) - use this information to create a separate Connection Profile of Account Type > Azure Active Directory as described here:
https://helpcenter.netwrix.com/bundle/AccessAnalyzer_12.0/page/Content/EnterpriseAuditor/Admin/Settings/Connection/Profile/EntraID.htm

Please, let me know results. And if you need additional assistance - please, let me know, I will be happy to help.

Best regards,
Artem Naskal
Technical Support Engineer EMEA
____________________ _________
Cybersecurity That Works for You

6160 Warren Parkway, Suite 100, Frisco, TX 75034
www.netwrix.com


--------------- Original Message ---------------
From: St Margarets Hospice [support@smhtechnicalservices.freshdesk.com]
Sent: 4/17/2025 5:59 PM
To: techsupport@netwrix.com
Subject: Ticket Received - Netwrix Support Ticket #00442427 - RegisterAzureAppAuth - ref:_00D7000000091pB._500Qk00000O9ytZ:ref

ref:_00D7091pB._500Q000O9ytZ:ref



Dear Netwrix Support,

Thank you for reaching out to us. This email is to confirm that we have received your request, and a ticket has been created.

This is the information we've received from you:

Dear Liam Rice,

Thank you for contacting us! We're writing to let you know we've received your Support request! Everyone here at Netwrix appreciates you taking the time to bring your comments, issues or suggestions to our attention. Each customer inquiry helps improve our products and services and ensures that we are meeting your needs.

Feel confident that a Netwrix team member will respond to you as soon as possible. The good news is that we use real Netwrix employees to respond to you personally. Because we put extra attention into every customer support question, we respond within the time specified in your Service Level Agreement. Please refer to the Support Reference Guide for further information on our SLA which can be found here: https://www.netwrix.com/download/documents/Customer_Support_Reference_Guide.pdf

To provide us with additional details or updates, you can simply reply to this message via email. Please be sure to leave the subject and body of this email in place.

Ticket number: 00442427

Thanks again!

The Netwrix Support Team

www.netwrix.com | Twitter: @netwrix


ref:_00D7000000091pB._500Qk00000O9ytZ:ref

________________________________

Please be aware that emails sent between organisations are not always secure. Please therefore do not enclose identifiable patient information if replying to this email.

If you need to add any additional information, images or documents to your ticket, please include them in response to this email now.

Our team is now aware of your concern and will review it as soon as possible. We appreciate your patience, and we'll keep you updated on our progress.

You can find many helpful guides by going onto Teams > Organisational Information > IT Guides.

Thank you for your patience.

Sincerely,

St Margaret's Hospice IT Services Team


39765:1271660","RE: Ticket Received - Netwrix Support Ticket #00442427 - RegisterAzureAppAuth -     [ ref:!00D70091pB.!500Qk0O9ytZ:ref ]","techsupport@netwrix.com","Netwrix Support","support@smhtechnicalservices.freshdesk.com","","","false","2025-04-17T15:10:46.000Z","true"
"02sQk00000NqvJbIAJ","500Qk00000O9ytZIAR","2025-04-17T15:37:20.000Z","2025-04-17T15:37:20.000Z","ref:_00D7091pB._500Q000O9ytZ:ref

Dear Netwrix Support, 
   Your IT support ticket has been marked as resolved. 
   
    If you feel the issue hasn’t been fully resolved, please reply to this email to reopen the ticket, and we’ll be happy to assist further.
   
   
    If you’re satisfied with the service you received, please take a moment to click the positive feedback button below to let us know.","Ticket Resolved - Netwrix Support Ticket #00442427 - RegisterAzureAppAuth - ref:_00D7000000091pB._500Qk00000O9ytZ:ref","support@smhtechnicalservices.freshdesk.com","St Margarets Hospice","techsupport@netwrix.com","","","false","2025-04-17T15:37:10.000Z","true"
"02sQk00000NqxMxIAJ","500Qk00000O9ytZIAR","2025-04-17T15:41:30.000Z","2025-04-17T15:48:18.000Z","ref:_00D7091pB._500Q000O9ytZ:ref

I have found a workaround and it wasnt missing permissions. I used powershell to first connect to graph by using Connect-MgGraph, by leaving that powershell open it had already pre-authenticated me utilizing exactly the same user that was registered in the system. It then went rhough and registered the app fine and produced the required certificate. It still produced an error but this seems to be after the app was created and is more of a checking stage. 


So from my point of view the request can be closed as I found a solution myself. Thanks
Check-PsMutexba8e57c8be15 : Cannot bind argument to parameter 'inputObject' because it is null.
at , : line 228","Netwrix Support Ticket #442427 - RegisterAzureAppAuth","itservices@st-margarets-hospice.org.uk","Liam Rice","techsupport@netwrix.com","","","false","2025-04-17T15:41:30.000Z","true"
"02sQk00000Nr1iIIAR","500Qk00000O9ytZIAR","2025-04-17T15:42:35.000Z","2025-04-17T15:42:35.000Z","ref:_00D7091pB._500Q000O9ytZ:ref

Dear Netwrix Support, 

 Thank you for reaching out to us. This email is to confirm that we have received your request, and a ticket has been created. 

 This is the information we've received from you: 
Dear Liam,

The support ticket 00442427 has been closed with the ""Closed - By Client"" status. If you feel that it was closed by mistake, just reply to this email.

We would be happy to receive your feedback about the quality of our customer service. If you have any complaints or suggestions, please share them with Support management: netwrix.techsupport.managers@netwrix.com<mailto:netwrix.techsupport.managers@netwrix.com>

Ticket subject: RegisterAzureAppAuth

Best regards,

Artem Naskal
Netwrix Support

Netwrix Corporation
Powerful Data Security Made Easy

6160 Warren Parkway, Suite 100, Frisco, TX 75034
Phone: 1-949-407-5125 x1

www.netwrix.com<https://www.netwrix.com> | Twitter: @netwrix


ref:_00D7000000091pB._500Qk00000O9ytZ:ref[https://nwxcorp.my.salesforce.com/servlet/servlet.ImageServer?oid=00D7000000091pB&esid=018Qk00000LJVvS&from=ext]
________________________________

Please be aware that emails sent between organisations are not always secure. Please therefore do not enclose identifiable patient information if replying to this email.

 

 If you need to add any additional information, images or documents to your ticket, please include them in response to this email now.  

 Our team is now aware of your concern and will review it as soon as possible. We appreciate your patience, and we'll keep you updated on our progress. 

 You can find many helpful guides by going onto Teams > Organisational Information > IT Guides. 

 Thank you for your patience. 

 Sincerely, 

 St Margaret's Hospice IT Services Team","Netwrix Support Ticket #442427 - ref:_00D7091pB._500Q000O9ytZ:ref - Ticket Received - Support Ticket Closed - RegisterAzureAppAuth - ref:_00D7000000091pB._500Qk00000O9ytZ:ref","support@smhtechnicalservices.freshdesk.com","St Margarets Hospice","techsupport@netwrix.com","","","false","2025-04-17T15:42:27.000Z","true"
"02sQk00000Nr4Y5IAJ","500Qk00000O9ytZIAR","2025-04-17T15:54:30.000Z","2025-04-17T15:54:30.000Z","Hi Liam,

Thank you for the prompt reply and for sharing the workaround details. I am glad to hear issue is resolved for you. 

The following is a summary of the ticket for your records:

The RegisterAzureaooAuth was failing with this error:
Connect-MgGraph : The type initializer for 'Azure.Identity.AuthenticationRecord' threw an exception.
At line:85 char:13
+ $userAuth = Connect-MgGraph -TenantId $tenantId -Scopes 'Application. ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
: Could not connect to MS Graph API
at , : line 91
Connect-MgGraph : The type initializer for 'Azure.Identity.AuthenticationRecord' threw an exception.
At line:89 char:17
+ $userAuth = Connect-MgGraph -TenantId $tenantId
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

You resolved this by per-authenticating into Microsoft Graph API via PowerShell. 

I will close this ticket now, but if you notice the same issue again or in case you need additional assistance - you can re-open this ticket by replying to this email.
Thank you!

Best regards,
Artem Naskal
Technical Support Engineer EMEA
____________________ _________
Cybersecurity That Works for You

6160 Warren Parkway, Suite 100, Frisco, TX 75034
www.netwrix.com


--------------- Original Message ---------------
From: Liam Rice [itservices@st-margarets-hospice.org.uk]
Sent: 4/17/2025 7:41 PM
To: techsupport@netwrix.com
Subject: Netwrix Support Ticket #442427 - RegisterAzureAppAuth

ref:_00D7091pB._500Q000O9ytZ:ref

I have found a workaround and it wasnt missing permissions. I used powershell to first connect to graph by using Connect-MgGraph, by leaving that powershell open it had already pre-authenticated me utilizing exactly the same user that was registered in the system. It then went rhough and registered the app fine and produced the required certificate. It still produced an error but this seems to be after the app was created and is more of a checking stage.


So from my point of view the request can be closed as I found a solution myself. Thanks
Check-PsMutexba8e57c8be15 : Cannot bind argument to parameter 'inputObject' because it is null.
at , : line 228","RE: Netwrix Support Ticket #442427 - RegisterAzureAppAuth    [ ref:!00D70091pB.!500Qk0O9ytZ:ref ]","techsupport@netwrix.com","Netwrix Support","itservices@st-margarets-hospice.org.uk","","","false","2025-04-17T15:54:28.000Z","true"
"02sQk00000Nr2cmIAB","500Qk00000O9ytZIAR","2025-04-17T15:54:51.000Z","2025-04-17T22:19:30.000Z","ref:_00D7091pB._500Q000O9ytZ:ref

Dear Netwrix Support, 

 Thank you for reaching out to us. This email is to confirm that we have received your request, and a ticket has been created. 

 This is the information we've received from you: 
Hi Liam,

Thank you for the prompt reply and for sharing the workaround details. I am glad to hear issue is resolved for you.

The following is a summary of the ticket for your records:

The RegisterAzureaooAuth was failing with this error:
Connect-MgGraph : The type initializer for 'Azure.Identity.AuthenticationRecord' threw an exception.
At line:85 char:13
+ $userAuth = Connect-MgGraph -TenantId $tenantId -Scopes 'Application. ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
: Could not connect to MS Graph API
at , : line 91
Connect-MgGraph : The type initializer for 'Azure.Identity.AuthenticationRecord' threw an exception.
At line:89 char:17
+ $userAuth = Connect-MgGraph -TenantId $tenantId
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

You resolved this by per-authenticating into Microsoft Graph API via PowerShell.

I will close this ticket now, but if you notice the same issue again or in case you need additional assistance - you can re-open this ticket by replying to this email.
Thank you!

Best regards,
Artem Naskal
Technical Support Engineer EMEA
____________________ _________
Cybersecurity That Works for You

6160 Warren Parkway, Suite 100, Frisco, TX 75034
www.netwrix.com


--------------- Original Message ---------------
From: Liam Rice [itservices@st-margarets-hospice.org.uk<mailto:itservices@st-margarets-hospice.org.uk>]
Sent: 4/17/2025 7:41 PM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Subject: Netwrix Support Ticket #442427 - RegisterAzureAppAuth

ref:_00D7091pB._500Q000O9ytZ:ref

I have found a workaround and it wasnt missing permissions. I used powershell to first connect to graph by using Connect-MgGraph, by leaving that powershell open it had already pre-authenticated me utilizing exactly the same user that was registered in the system. It then went rhough and registered the app fine and produced the required certificate. It still produced an error but this seems to be after the app was created and is more of a checking stage.


So from my point of view the request can be closed as I found a solution myself. Thanks
Check-PsMutexba8e57c8be15 : Cannot bind argument to parameter 'inputObject' because it is null.
at , : line 228

[https://nwxcorp.my.salesforce.com/servlet/servlet.ImageServer?oid=00D7000000091pB&esid=018Qk00000LJcQT&from=ext]


________________________________

Please be aware that emails sent between organisations are not always secure. Please therefore do not enclose identifiable patient information if replying to this email.

 

 If you need to add any additional information, images or documents to your ticket, please include them in response to this email now.  

 Our team is now aware of your concern and will review it as soon as possible. We appreciate your patience, and we'll keep you updated on our progress. 

 You can find many helpful guides by going onto Teams > Organisational Information > IT Guides. 

 Thank you for your patience. 

 Sincerely, 

 St Margaret's Hospice IT Services Team","Ticket Received - RE: Netwrix Support Ticket #442427 - RegisterAzureAppAuth [ ref:!00D70091pB.!500Qk0O9ytZ:ref ]","support@smhtechnicalservices.freshdesk.com","St Margarets Hospice","techsupport@netwrix.com","","","false","2025-04-17T15:54:43.000Z","true"
