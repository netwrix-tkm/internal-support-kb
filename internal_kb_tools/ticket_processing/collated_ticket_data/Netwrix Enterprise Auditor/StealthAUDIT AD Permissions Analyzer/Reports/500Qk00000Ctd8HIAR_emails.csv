"Id","ParentId","CreatedDate","LastModifiedDate","TextBody","Subject","FromAddress","FromName","ToAddress","CcAddress","BccAddress","HasAttachment","MessageDate","IsExternallyVisible"
"02sQk00000CQAmSIAX","500Qk00000Ctd8HIAR","2024-07-10T17:48:45.000Z","2024-07-10T17:48:45.000Z","Robert,

Thank you for reaching out to support. 

Please note your customer so we can correctly update the ticket.

To update/confirm our Technical Support Notes & start the investigation, could we get the text output (copy&past) from the following ADMIN PowerShell ISE script block on the systems that are running Netwrix/Stealth Server applications?

Clear-Host  # Clears the console window for better readability. 
#Netwrix/Stealth, PostgreSQL, Python application versions:
Get-CimInstance -Class Win32_Product |
Where-Object {($_.Name -Like ""Stealth*"" -or $_.Name -like ""Netwrix*"" -or $_.Name -like ""*Postg*"" -or ` $_.Name -like ""Python*"")} -ErrorAction SilentlyContinue |
Sort-Object | Format-Table Name,Version,InstallDate -AutoSize 

#Netwrix Enterprise Auditor (NEA) formally StealthAUDIT (SA) install path
$env:SAINSTALLDIR 

#Netwrix Access Information Center (AIC) formally StealthAUDIT Access Information Center (AIC) install path
(Get-ItemProperty -Path ""HKLM:SYSTEMCurrentControlSetServicesAccessInformationCenter""-ErrorAction SilentlyContinue).ImagePath.Replace(""`"""", """").Replace(""BinAccessInformationCenter.Service.exe"", """")


Please note the following:
Netwrix Enterprise Auditor v11.6 > Solutions > Active Directory Solution > Active Directory Job Group > 2.Users Job Group > AD_WeakPasswords Job:
Delegable Admins – Administrator account is allowed to be delegated to a service
https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_WeakPasswords.htm

Netwrix Enterprise Auditor v11.6 > Solutions > Active Directory Solution > 2.1Jsers Job Group > AD_UserDelegation Job
The AD_Delegation Job highlights user accounts which are trusted for delegation.
https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_UserDelegation.htm

Checking that this is the correct correlation, as well as any options to directly check within AD?

Thank You for your time.

Dusty Grayson
Sr. Support Engineer
Phone: 1-949-407-5125 | Toll-free: 888-638-9749
____________________ __________
Cybersecurity That Works for You.
6160 Warren Parkway, Suite 100,Frisco, TX 75034
www.netwrix.com

*****Please note Support communication changes*****
Directly emailing Support Engineers is likely to result in oversight, as they do not handle cases through email correspondence.
It is recommended to use the Support Portal for appropriate communication channels. https://www.netwrix.com/sign_in.html?rf=my_tickets.html

Emailing into support@stealthbits.com has been disabled as well.
ref:!00D70091pB.!500Qk0Ctd8H:ref","weak passwords job - what exactly is ""trusted for delegation""    [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]","techsupport@netwrix.com","Netwrix Support","robert.parsons@optiv.com","","dusty.grayson@netwrix.com","false","2024-07-10T17:48:44.000Z","true"
"02sQk00000CQUF2IAP","500Qk00000Ctd8HIAR","2024-07-10T18:38:36.000Z","2024-07-10T18:38:36.000Z","ref:_00D7091pB._500Q000Ctd8H:ref

Thanks Dusty.  The customer is Trintech International.  I don't have remote access so I can't get the version numbers, but I don't think that info will affect my questions.

This question is specifically about what the Weak Passwords job checks to determine that someone is a ""delegable admin"".  The link to the weak passwords job documentation only gives this info:

  *   Delegable Admins - Administrator account is allowed to be delegated to a service
That isn't enough info, hence the inquiry.

My question about the two attributes is because I thought they might be related to the condition checked by the weak passwords job.  I'm not asking about the User Delegation job, so if those attributes only come from there and are in no way related to the weak passwords job, that's all I would need confirmation on with respect to those attributes.

-Robert


From: Netwrix Support <techsupport@netwrix.com>
Sent: Wednesday, July 10, 2024 10:49 AM
To: Robert Parsons <robert.parsons@optiv.com>
Subject: weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]

Robert,

Thank you for reaching out to support.

Please note your customer so we can correctly update the ticket.

To update/confirm our Technical Support Notes & start the investigation, could we get the text output (copy&past) from the following ADMIN PowerShell ISE script block on the systems that are running Netwrix/Stealth Server applications?

Clear-Host  # Clears the console window for better readability.
#Netwrix/Stealth, PostgreSQL, Python application versions:
Get-CimInstance -Class Win32_Product |
Where-Object {($_.Name -Like ""Stealth*"" -or $_.Name -like ""Netwrix*"" -or $_.Name -like ""*Postg*"" -or ` $_.Name -like ""Python*"")} -ErrorAction SilentlyContinue |
Sort-Object | Format-Table Name,Version,InstallDate -AutoSize

#Netwrix Enterprise Auditor (NEA) formally StealthAUDIT (SA) install path
$env:SAINSTALLDIR

#Netwrix Access Information Center (AIC) formally StealthAUDIT Access Information Center (AIC) install path
(Get-ItemProperty -Path ""HKLM:SYSTEMCurrentControlSetServicesAccessInformationCenter""-ErrorAction SilentlyContinue).ImagePath.Replace(""`"""", """").Replace(""BinAccessInformationCenter.Service.exe"", """")


Please note the following:
Netwrix Enterprise Auditor v11.6 > Solutions > Active Directory Solution > Active Directory Job Group > 2.Users Job Group > AD_WeakPasswords Job:
Delegable Admins - Administrator account is allowed to be delegated to a service
https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_WeakPasswords.htm<https://urldefense.com/v3/__https:/helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_WeakPasswords.htm__;!!CiF3mHgEawk!HAqCDE-MZ68EX-Fo0A3cg-_Sx8P3fYOFjTskbArfiNFiEL3ddkMnvYUqJ7nLubHef80lWCpLDxgPDQYe6roNmDWJ6w$>

Netwrix Enterprise Auditor v11.6 > Solutions > Active Directory Solution > 2.1Jsers Job Group > AD_UserDelegation Job
The AD_Delegation Job highlights user accounts which are trusted for delegation.
https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_UserDelegation.htm<https://urldefense.com/v3/__https:/helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_UserDelegation.htm__;!!CiF3mHgEawk!HAqCDE-MZ68EX-Fo0A3cg-_Sx8P3fYOFjTskbArfiNFiEL3ddkMnvYUqJ7nLubHef80lWCpLDxgPDQYe6rqSJW8sPw$>

Checking that this is the correct correlation, as well as any options to directly check within AD?

Thank You for your time.

Dusty Grayson
Sr. Support Engineer
Phone: 1-949-407-5125 | Toll-free: 888-638-9749
____________________ __________
Cybersecurity That Works for You.
6160 Warren Parkway, Suite 100,Frisco, TX 75034
www.netwrix.com<https://urldefense.com/v3/__http:/www.netwrix.com__;!!CiF3mHgEawk!HAqCDE-MZ68EX-Fo0A3cg-_Sx8P3fYOFjTskbArfiNFiEL3ddkMnvYUqJ7nLubHef80lWCpLDxgPDQYe6rplu9vtlw$>

*****Please note Support communication changes*****
Directly emailing Support Engineers is likely to result in oversight, as they do not handle cases through email correspondence.
It is recommended to use the Support Portal for appropriate communication channels. https://www.netwrix.com/sign_in.html?rf=my_tickets.html<https://urldefense.com/v3/__https:/www.netwrix.com/sign_in.html?rf=my_tickets.html__;!!CiF3mHgEawk!HAqCDE-MZ68EX-Fo0A3cg-_Sx8P3fYOFjTskbArfiNFiEL3ddkMnvYUqJ7nLubHef80lWCpLDxgPDQYe6rrx50432g$>

Emailing into support@stealthbits.com<mailto:support@stealthbits.com> has been disabled as well.

ref:!00D70091pB.!500Qk0Ctd8H:ref","RE: Netwrix Support Ticket #414656 - ref:_00D7091pB._500Q000Ctd8H:ref - weak passwords job - what exactly is ""trusted for delegation""    [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]","robert.parsons@optiv.com","Robert Parsons","techsupport@netwrix.com","","","false","2024-07-10T18:37:49.000Z","true"
"02sQk00000CR1U9IAL","500Qk00000Ctd8HIAR","2024-07-10T20:41:43.000Z","2024-07-10T20:41:43.000Z","Robert,

Here is some non Dev feed back:

Active Directory: How to View or Delete Delegated Permissions
https://learn.microsoft.com/en-us/archive/technet-wiki/6477.active-directory-how-to-view-or-delete-delegated-permissions      

Detecting Delegated Permissions in Active Directory
https://blog.netwrix.com/2016/10/27/detecting-delegated-permissions-in-active-directory/  

Active Directory Delegation Overview
https://blog.netwrix.com/2022/11/14/active_directory_delegation/#:~:text=How%20do%20I%20check%20delegation%20in%20Active%20Directory%3F,the%20Security%20tab%20to%20view%20the%20delegated%20permissions  

Dusty Grayson
Sr. Support Engineer
Phone: 1-949-407-5125 | Toll-free: 888-638-9749
____________________ __________
Cybersecurity That Works for You.
6160 Warren Parkway, Suite 100,Frisco, TX 75034
www.netwrix.com

*****Please note Support communication changes*****
Directly emailing Support Engineers is likely to result in oversight, as they do not handle cases through email correspondence.
It is recommended to use the Support Portal for appropriate communication channels. https://www.netwrix.com/sign_in.html?rf=my_tickets.html

Emailing into support@stealthbits.com has been disabled as well.


--------------- Original Message ---------------
From: Robert Parsons [robert.parsons@optiv.com]
Sent: 7/10/2024 2:37 PM
To: techsupport@netwrix.com
Subject: RE: Netwrix Support Ticket #414656 - ref:_00D7091pB._500Q000Ctd8H:ref - weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]

ref:_00D7091pB._500Q000Ctd8H:ref




Thanks Dusty.  The customer is Trintech International.  I don’t have remote access so I can’t get the version numbers, but I don’t think that info will affect my questions.

 

This question is specifically about what the Weak Passwords job checks to determine that someone is a “delegable admin”.  The link to the weak passwords job documentation only gives this info:


	Delegable Admins – Administrator account is allowed to be delegated to a service


That isn’t enough info, hence the inquiry.

 

My question about the two attributes is because I thought they might be related to the condition checked by the weak passwords job.  I’m not asking about the User Delegation job, so if those attributes only come from there and are in no way related to the weak passwords job, that’s all I would need confirmation on with respect to those attributes.

 

-Robert

 

 



From: Netwrix Support <techsupport@netwrix.com>
Sent: Wednesday, July 10, 2024 10:49 AM
To: Robert Parsons <robert.parsons@optiv.com>
Subject: weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]



 

Robert,

Thank you for reaching out to support. 

Please note your customer so we can correctly update the ticket.

To update/confirm our Technical Support Notes & start the investigation, could we get the text output (copy&past) from the following ADMIN PowerShell ISE script block on the systems that are running Netwrix/Stealth Server applications?

Clear-Host  # Clears the console window for better readability. 
#Netwrix/Stealth, PostgreSQL, Python application versions:
Get-CimInstance -Class Win32_Product |
Where-Object {($_.Name -Like ""Stealth*"" -or $_.Name -like ""Netwrix*"" -or $_.Name -like ""*Postg*"" -or ` $_.Name -like ""Python*"")} -ErrorAction SilentlyContinue |
Sort-Object | Format-Table Name,Version,InstallDate -AutoSize 

#Netwrix Enterprise Auditor (NEA) formally StealthAUDIT (SA) install path
$env:SAINSTALLDIR 

#Netwrix Access Information Center (AIC) formally StealthAUDIT Access Information Center (AIC) install path
(Get-ItemProperty -Path ""HKLM:SYSTEMCurrentControlSetServicesAccessInformationCenter""-ErrorAction SilentlyContinue).ImagePath.Replace(""`"""", """").Replace(""BinAccessInformationCenter.Service.exe"", """")


Please note the following:
Netwrix Enterprise Auditor v11.6 > Solutions > Active Directory Solution > Active Directory Job Group > 2.Users Job Group > AD_WeakPasswords Job:
Delegable Admins – Administrator account is allowed to be delegated to a service
https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_WeakPasswords.htm

Netwrix Enterprise Auditor v11.6 > Solutions > Active Directory Solution > 2.1Jsers Job Group > AD_UserDelegation Job
The AD_Delegation Job highlights user accounts which are trusted for delegation.
https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_UserDelegation.htm

Checking that this is the correct correlation, as well as any options to directly check within AD?

Thank You for your time.

Dusty Grayson
Sr. Support Engineer
Phone: 1-949-407-5125 | Toll-free: 888-638-9749
____________________ __________
Cybersecurity That Works for You.
6160 Warren Parkway, Suite 100,Frisco, TX 75034
www.netwrix.com

*****Please note Support communication changes*****
Directly emailing Support Engineers is likely to result in oversight, as they do not handle cases through email correspondence.
It is recommended to use the Support Portal for appropriate communication channels.  https://www.netwrix.com/sign_in.html?rf=my_tickets.html

Emailing into support@stealthbits.com has been disabled as well.

ref:!00D70091pB.!500Qk0Ctd8H:ref","RE: Netwrix Support Ticket #414656 -  - weak passwords job - what exactly is ""trusted for delegation""    [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]","techsupport@netwrix.com","Netwrix Support","robert.parsons@optiv.com","","","false","2024-07-10T20:41:42.000Z","true"
"02sQk00000CR8PDIA1","500Qk00000Ctd8HIAR","2024-07-10T21:21:08.000Z","2024-07-10T21:21:08.000Z","ref:_00D7091pB._500Q000Ctd8H:ref

Thanks Dusty, those are good general info links and I didn't have most of them in my bookmarks already!

What I'm looking for here in this case won't be covered by those (unless I completely missed it in scanning thru them), because the question relates specifically to NEA and what ""delegatable admin"" means in the application there (specifically the weak passwords job report).

After some additional digging and guessing, I have to think that it means an account has to meet two criteria:

  *   The item ""Account is sensitive and cannot be delegated"" is *NOT* set on a user (AD users and computers > Account tab)
  *   The user *IS* a member of some sort of administrative group, perhaps such as Domain Admins

So:

  *   Can we get confirmation if the above criteria is what the weak password means when it says an account is a ""delegatable admin"" and
  *   If that is what it means, what are the list of groups that count as considering the account an admin?  Additionally are there any other conditions besides group membership that would make an account be considered an admin for the purposes of this question?

I realize that this question is likely to require code review unless someone has significantly more documentation than you and I have come across so far.  Please raise the question to development, which is sounds like you already may have done.

As always, I appreciate all your help with my questions.  I know that can be the weird ones most of the time!


Best regards,

Robert Parsons  |  CISSP, Security+
Sr. Consultant II - Data Governance and Protection
robert.parsons@optiv.com<mailto:robert.parsons@optiv.com>           www.optiv.com<https://urldefense.proofpoint.com/v2/url?u=http-3A__www.optiv.com_&d=DwMFAg&c=TxO9TIZxM1NIgbR_44vEiALc2o8uaxixBRc1BtwrN08&r=wTusx-C4z2FLLedAEYQA2ozDXRjnwAwY5MOqtGX_LBk&m=p9KOsVL_mUfnoCxj5P_b8DcgXpb1Ej1lTcI7g9q-VEU&s=drEl314f8l2OncEDuCSZoOe-bqerVSqKZID1ECMT_9E&e=>
[cid:image001.png@01DAD2D4.2F465890]






From: Netwrix Support <techsupport@netwrix.com>
Sent: Wednesday, July 10, 2024 1:42 PM
To: Robert Parsons <robert.parsons@optiv.com>
Subject: RE: Netwrix Support Ticket #414656 - - weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]


Robert,

Here is some non Dev feed back:

Active Directory: How to View or Delete Delegated Permissions
https://learn.microsoft.com/en-us/archive/technet-wiki/6477.active-directory-how-to-view-or-delete-delegated-permissions<https://urldefense.com/v3/__https:/learn.microsoft.com/en-us/archive/technet-wiki/6477.active-directory-how-to-view-or-delete-delegated-permissions__;!!CiF3mHgEawk!H-Ix2T-qP8iVe-ICd-luDBuidIHsm_WdHHKjUhHdHOr7RRo9zinwYSwEaXNJsVILQ1Sc2bK8w3aW1vzsb2Iq-hyRlQ$>

Detecting Delegated Permissions in Active Directory
https://blog.netwrix.com/2016/10/27/detecting-delegated-permissions-in-active-directory/<https://urldefense.com/v3/__https:/blog.netwrix.com/2016/10/27/detecting-delegated-permissions-in-active-directory/__;!!CiF3mHgEawk!H-Ix2T-qP8iVe-ICd-luDBuidIHsm_WdHHKjUhHdHOr7RRo9zinwYSwEaXNJsVILQ1Sc2bK8w3aW1vzsb2I8l1NDPw$>

Active Directory Delegation Overview
https://blog.netwrix.com/2022/11/14/active_directory_delegation/#:~:text=How%20do%20I%20check%20delegation%20in%20Active%20Directory%3F,the%20Security%20tab%20to%20view%20the%20delegated%20permissions<https://urldefense.com/v3/__https:/blog.netwrix.com/2022/11/14/active_directory_delegation/*:*:text=How*20do*20I*20check*20delegation*20in*20Active*20Directory*3F,the*20Security*20tab*20to*20view*20the*20delegated*20permissions__;I34lJSUlJSUlJSUlJSUlJSU!!CiF3mHgEawk!H-Ix2T-qP8iVe-ICd-luDBuidIHsm_WdHHKjUhHdHOr7RRo9zinwYSwEaXNJsVILQ1Sc2bK8w3aW1vzsb2LlNvYwTA$>

Dusty Grayson
Sr. Support Engineer
Phone: 1-949-407-5125 | Toll-free: 888-638-9749
____________________ __________
Cybersecurity That Works for You.
6160 Warren Parkway, Suite 100,Frisco, TX 75034
www.netwrix.com<https://urldefense.com/v3/__http:/www.netwrix.com__;!!CiF3mHgEawk!H-Ix2T-qP8iVe-ICd-luDBuidIHsm_WdHHKjUhHdHOr7RRo9zinwYSwEaXNJsVILQ1Sc2bK8w3aW1vzsb2JOguykxw$>

*****Please note Support communication changes*****
Directly emailing Support Engineers is likely to result in oversight, as they do not handle cases through email correspondence.
It is recommended to use the Support Portal for appropriate communication channels. https://www.netwrix.com/sign_in.html?rf=my_tickets.html<https://urldefense.com/v3/__https:/www.netwrix.com/sign_in.html?rf=my_tickets.html__;!!CiF3mHgEawk!H-Ix2T-qP8iVe-ICd-luDBuidIHsm_WdHHKjUhHdHOr7RRo9zinwYSwEaXNJsVILQ1Sc2bK8w3aW1vzsb2IL6XWMqw$>

Emailing into support@stealthbits.com<mailto:support@stealthbits.com> has been disabled as well.


--------------- Original Message ---------------
From: Robert Parsons [robert.parsons@optiv.com]
Sent: 7/10/2024 2:37 PM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Subject: RE: Netwrix Support Ticket #414656 - ref:_00D7091pB._500Q000Ctd8H:ref - weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]

ref:_00D7091pB._500Q000Ctd8H:ref


Thanks Dusty.  The customer is Trintech International.  I don't have remote access so I can't get the version numbers, but I don't think that info will affect my questions.

This question is specifically about what the Weak Passwords job checks to determine that someone is a ""delegable admin"".  The link to the weak passwords job documentation only gives this info:

  1.  Delegable Admins - Administrator account is allowed to be delegated to a service
That isn't enough info, hence the inquiry.

My question about the two attributes is because I thought they might be related to the condition checked by the weak passwords job.  I'm not asking about the User Delegation job, so if those attributes only come from there and are in no way related to the weak passwords job, that's all I would need confirmation on with respect to those attributes.

-Robert


From: Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Sent: Wednesday, July 10, 2024 10:49 AM
To: Robert Parsons <robert.parsons@optiv.com<mailto:robert.parsons@optiv.com>>
Subject: weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]

Robert,

Thank you for reaching out to support.

Please note your customer so we can correctly update the ticket.

To update/confirm our Technical Support Notes & start the investigation, could we get the text output (copy&past) from the following ADMIN PowerShell ISE script block on the systems that are running Netwrix/Stealth Server applications?

Clear-Host  # Clears the console window for better readability.
#Netwrix/Stealth, PostgreSQL, Python application versions:
Get-CimInstance -Class Win32_Product |
Where-Object {($_.Name -Like ""Stealth*"" -or $_.Name -like ""Netwrix*"" -or $_.Name -like ""*Postg*"" -or ` $_.Name -like ""Python*"")} -ErrorAction SilentlyContinue |
Sort-Object | Format-Table Name,Version,InstallDate -AutoSize

#Netwrix Enterprise Auditor (NEA) formally StealthAUDIT (SA) install path
$env:SAINSTALLDIR

#Netwrix Access Information Center (AIC) formally StealthAUDIT Access Information Center (AIC) install path
(Get-ItemProperty -Path ""HKLM:SYSTEMCurrentControlSetServicesAccessInformationCenter""-ErrorAction SilentlyContinue).ImagePath.Replace(""`"""", """").Replace(""BinAccessInformationCenter.Service.exe"", """")


Please note the following:
Netwrix Enterprise Auditor v11.6 > Solutions > Active Directory Solution > Active Directory Job Group > 2.Users Job Group > AD_WeakPasswords Job:
Delegable Admins - Administrator account is allowed to be delegated to a service
https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_WeakPasswords.htm<https://urldefense.com/v3/__https:/helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_WeakPasswords.htm__;!!CiF3mHgEawk!HAqCDE-MZ68EX-Fo0A3cg-_Sx8P3fYOFjTskbArfiNFiEL3ddkMnvYUqJ7nLubHef80lWCpLDxgPDQYe6roNmDWJ6w$>

Netwrix Enterprise Auditor v11.6 > Solutions > Active Directory Solution > 2.1Jsers Job Group > AD_UserDelegation Job
The AD_Delegation Job highlights user accounts which are trusted for delegation.
https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_UserDelegation.htm<https://urldefense.com/v3/__https:/helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_UserDelegation.htm__;!!CiF3mHgEawk!HAqCDE-MZ68EX-Fo0A3cg-_Sx8P3fYOFjTskbArfiNFiEL3ddkMnvYUqJ7nLubHef80lWCpLDxgPDQYe6rqSJW8sPw$>

Checking that this is the correct correlation, as well as any options to directly check within AD?

Thank You for your time.

Dusty Grayson
Sr. Support Engineer
Phone: 1-949-407-5125 | Toll-free: 888-638-9749
____________________ __________
Cybersecurity That Works for You.
6160 Warren Parkway, Suite 100,Frisco, TX 75034
www.netwrix.com<https://urldefense.com/v3/__http:/www.netwrix.com__;!!CiF3mHgEawk!HAqCDE-MZ68EX-Fo0A3cg-_Sx8P3fYOFjTskbArfiNFiEL3ddkMnvYUqJ7nLubHef80lWCpLDxgPDQYe6rplu9vtlw$>

*****Please note Support communication changes*****
Directly emailing Support Engineers is likely to result in oversight, as they do not handle cases through email correspondence.
It is recommended to use the Support Portal for appropriate communication channels. https://www.netwrix.com/sign_in.html?rf=my_tickets.html<https://urldefense.com/v3/__https:/www.netwrix.com/sign_in.html?rf=my_tickets.html__;!!CiF3mHgEawk!HAqCDE-MZ68EX-Fo0A3cg-_Sx8P3fYOFjTskbArfiNFiEL3ddkMnvYUqJ7nLubHef80lWCpLDxgPDQYe6rrx50432g$>

Emailing into support@stealthbits.com<mailto:support@stealthbits.com> has been disabled as well.

ref:!00D70091pB.!500Qk0Ctd8H:ref","RE: Netwrix Support Ticket #414656 -  - weak passwords job - what exactly is ""trusted for delegation""    [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]","robert.parsons@optiv.com","Robert Parsons","techsupport@netwrix.com","","","true","2024-07-10T21:20:38.000Z","true"
"02sQk00000CSp2HIAT","500Qk00000Ctd8HIAR","2024-07-11T13:26:32.000Z","2024-07-11T13:26:32.000Z","Robert,

Here is what Dev had to note for our inquiry.

Essentially accounts that are administrators (i believe it just checks admincount = 1) and are not marked as 'sensitive and cannot be delegated' Admin accounts should not be delegated as they can be abused in a ton of ways, that is why that setting in AD exists
 https://specopssoft.com/blog/securing-authentication-tokens-by-preventing-delegation-of-admin-accounts/

Securing authentication tokens by preventing delegation of admin accounts
Recommended settings in Active Directory that mitigate the risk associated with account delegation on insecure computers and administrator accounts.
 
Security implications of delegable admins
Using freely available tools, attackers only need to compromise a client and access a standard account. Once they have their foot in the door, they can use tools like Meterpreter to list the available delegate tokens. Privileged accounts with delegation tokens available can lead to the attacker being able to steal a privileged user token, such as a domain admin account. Once the attacker has a domain admin-level account, the possibilities are endless.
Once they have high-level privileged accounts, they often go after backup files that may contain prized targets, such as backups of the NTDS.DIT database of Active Directory. If found, they can copy the database offsite and run an offline tool to compromise accounts in the organization further.
 
The “Account is sensitive and cannot be delegated” setting
Microsoft has provided a setting in Active Directory Domain Services that can help mitigate the issue. In addition, an Active Directory setting is recommended to be enabled for privileged accounts in the domain. The setting is “account is sensitive and cannot be delegated” within the account properties.
When configured, this setting strips the delegate-level token from the user, removing the user credentials. When configured, the logon becomes an ANONYMOUS login with no resource permissions.





Dusty Grayson
Sr. Support Engineer
Phone: 1-949-407-5125 | Toll-free: 888-638-9749
____________________ __________
Cybersecurity That Works for You.
6160 Warren Parkway, Suite 100,Frisco, TX 75034
www.netwrix.com

*****Please note Support communication changes*****
Directly emailing Support Engineers is likely to result in oversight, as they do not handle cases through email correspondence.
It is recommended to use the Support Portal for appropriate communication channels. https://www.netwrix.com/sign_in.html?rf=my_tickets.html

Emailing into support@stealthbits.com has been disabled as well.


--------------- Original Message ---------------
From: Robert Parsons [robert.parsons@optiv.com]
Sent: 7/10/2024 5:20 PM
To: techsupport@netwrix.com
Subject: RE: Netwrix Support Ticket #414656 - - weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]

ref:_00D7091pB._500Q000Ctd8H:ref



Thanks Dusty, those are good general info links and I didn’t have most of them in my bookmarks already!

 

What I’m looking for here in this case won’t be covered by those (unless I completely missed it in scanning thru them), because the question relates specifically to NEA and what “delegatable admin” means in the application there (specifically the weak passwords job report).   

 

After some additional digging and guessing, I have to think that it means an account has to meet two criteria:


	The item “Account is sensitive and cannot be delegated” is *NOT* set on a user (AD users and computers > Account tab)
	The user *IS* a member of some sort of administrative group, perhaps such as Domain Admins


 

So:


	Can we get confirmation if the above criteria is what the weak password means when it says an account is a “delegatable admin” and
	If that is what it means, what are the list of groups that count as considering the account an admin?  Additionally are there any other conditions besides group membership that would make an account be considered an admin for the purposes of this question?


 

I realize that this question is likely to require code review unless someone has significantly more documentation than you and I have come across so far.  Please raise the question to development, which is sounds like you already may have done.

 

As always, I appreciate all your help with my questions.  I know that can be the weird ones most of the time!

 

 

Best regards,

 

Robert Parsons  |  CISSP, Security+

Sr. Consultant II - Data Governance and Protection

robert.parsons@optiv.com            www.optiv.com



 

 

 

 

 

 



From: Netwrix Support <techsupport@netwrix.com>
Sent: Wednesday, July 10, 2024 1:42 PM
To: Robert Parsons <robert.parsons@optiv.com>
Subject: RE: Netwrix Support Ticket #414656 - - weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]



 

Robert,

Here is some non Dev feed back:

Active Directory: How to View or Delete Delegated Permissions
https://learn.microsoft.com/en-us/archive/technet-wiki/6477.active-directory-how-to-view-or-delete-delegated-permissions      

Detecting Delegated Permissions in Active Directory
https://blog.netwrix.com/2016/10/27/detecting-delegated-permissions-in-active-directory/  

Active Directory Delegation Overview
https://blog.netwrix.com/2022/11/14/active_directory_delegation/#:~:text=How%20do%20I%20check%20delegation%20in%20Active%20Directory%3F,the%20Security%20tab%20to%20view%20the%20delegated%20permissions  

Dusty Grayson
Sr. Support Engineer
Phone: 1-949-407-5125 | Toll-free: 888-638-9749
____________________ __________
Cybersecurity That Works for You.
6160 Warren Parkway, Suite 100,Frisco, TX 75034
www.netwrix.com

*****Please note Support communication changes*****
Directly emailing Support Engineers is likely to result in oversight, as they do not handle cases through email correspondence.
It is recommended to use the Support Portal for appropriate communication channels.  https://www.netwrix.com/sign_in.html?rf=my_tickets.html

Emailing into support@stealthbits.com has been disabled as well.


--------------- Original Message ---------------
From: Robert Parsons [robert.parsons@optiv.com]
Sent: 7/10/2024 2:37 PM
To: techsupport@netwrix.com
Subject: RE: Netwrix Support Ticket #414656 - ref:_00D7091pB._500Q000Ctd8H:ref - weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]

ref:_00D7091pB._500Q000Ctd8H:ref

 


Thanks Dusty.  The customer is Trintech International.  I don’t have remote access so I can’t get the version numbers, but I don’t think that info will affect my questions.

 

This question is specifically about what the Weak Passwords job checks to determine that someone is a “delegable admin”.  The link to the weak passwords job documentation only gives this info:


	Delegable Admins – Administrator account is allowed to be delegated to a service


That isn’t enough info, hence the inquiry.

 

My question about the two attributes is because I thought they might be related to the condition checked by the weak passwords job.  I’m not asking about the User Delegation job, so if those attributes only come from there and are in no way related to the weak passwords job, that’s all I would need confirmation on with respect to those attributes.

 

-Robert

 

 



From: Netwrix Support <techsupport@netwrix.com>
Sent: Wednesday, July 10, 2024 10:49 AM
To: Robert Parsons <robert.parsons@optiv.com>
Subject: weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]



 

Robert,

Thank you for reaching out to support. 

Please note your customer so we can correctly update the ticket.

To update/confirm our Technical Support Notes & start the investigation, could we get the text output (copy&past) from the following ADMIN PowerShell ISE script block on the systems that are running Netwrix/Stealth Server applications?

Clear-Host  # Clears the console window for better readability. 
#Netwrix/Stealth, PostgreSQL, Python application versions:
Get-CimInstance -Class Win32_Product |
Where-Object {($_.Name -Like ""Stealth*"" -or $_.Name -like ""Netwrix*"" -or $_.Name -like ""*Postg*"" -or ` $_.Name -like ""Python*"")} -ErrorAction SilentlyContinue |
Sort-Object | Format-Table Name,Version,InstallDate -AutoSize 

#Netwrix Enterprise Auditor (NEA) formally StealthAUDIT (SA) install path
$env:SAINSTALLDIR 

#Netwrix Access Information Center (AIC) formally StealthAUDIT Access Information Center (AIC) install path
(Get-ItemProperty -Path ""HKLM:SYSTEMCurrentControlSetServicesAccessInformationCenter""-ErrorAction SilentlyContinue).ImagePath.Replace(""`"""", """").Replace(""BinAccessInformationCenter.Service.exe"", """")


Please note the following:
Netwrix Enterprise Auditor v11.6 > Solutions > Active Directory Solution > Active Directory Job Group > 2.Users Job Group > AD_WeakPasswords Job:
Delegable Admins – Administrator account is allowed to be delegated to a service
https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_WeakPasswords.htm

Netwrix Enterprise Auditor v11.6 > Solutions > Active Directory Solution > 2.1Jsers Job Group > AD_UserDelegation Job
The AD_Delegation Job highlights user accounts which are trusted for delegation.
https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_UserDelegation.htm

Checking that this is the correct correlation, as well as any options to directly check within AD?

Thank You for your time.

Dusty Grayson
Sr. Support Engineer
Phone: 1-949-407-5125 | Toll-free: 888-638-9749
____________________ __________
Cybersecurity That Works for You.
6160 Warren Parkway, Suite 100,Frisco, TX 75034
www.netwrix.com

*****Please note Support communication changes*****
Directly emailing Support Engineers is likely to result in oversight, as they do not handle cases through email correspondence.
It is recommended to use the Support Portal for appropriate communication channels.  https://www.netwrix.com/sign_in.html?rf=my_tickets.html

Emailing into support@stealthbits.com has been disabled as well.

ref:!00D70091pB.!500Qk0Ctd8H:ref","RE: Netwrix Support Ticket #414656 -  - weak passwords job - what exactly is ""trusted for delegation""    [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]","techsupport@netwrix.com","Netwrix Support","robert.parsons@optiv.com","","","true","2024-07-11T13:26:31.000Z","true"
"02sQk00000CSmqsIAD","500Qk00000Ctd8HIAR","2024-07-11T14:38:03.000Z","2024-07-11T14:38:03.000Z","ref:_00D7091pB._500Q000Ctd8H:ref

Thanks Dusty!  This is the info I needed.  The ticket can be closed, and thanks for your help.

-Robert

From: Netwrix Support <techsupport@netwrix.com>
Sent: Thursday, July 11, 2024 6:27 AM
To: Robert Parsons <robert.parsons@optiv.com>
Subject: RE: Netwrix Support Ticket #414656 - - weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]

Robert,

Here is what Dev had to note for our inquiry.

Essentially accounts that are administrators (i believe it just checks admincount = 1) and are not marked as 'sensitive and cannot be delegated' Admin accounts should not be delegated as they can be abused in a ton of ways, that is why that setting in AD exists
 https://specopssoft.com/blog/securing-authentication-tokens-by-preventing-delegation-of-admin-accounts/<https://urldefense.com/v3/__https:/specopssoft.com/blog/securing-authentication-tokens-by-preventing-delegation-of-admin-accounts/__;!!CiF3mHgEawk!E6x73CeNirBEZg3CqSsJjAHyCDawVG48U3Q-JmmppBOujNws8dJtCzrPQny1mG3LLXdwN9_O1Hm6NRH7wL6ddlDblA$>

Securing authentication tokens by preventing delegation of admin accounts
Recommended settings in Active Directory that mitigate the risk associated with account delegation on insecure computers and administrator accounts.

Security implications of delegable admins
Using freely available tools, attackers only need to compromise a client and access a standard account. Once they have their foot in the door, they can use tools like Meterpreter to list the available delegate tokens. Privileged accounts with delegation tokens available can lead to the attacker being able to steal a privileged user token, such as a domain admin account. Once the attacker has a domain admin-level account, the possibilities are endless.
Once they have high-level privileged accounts, they often go after backup files that may contain prized targets, such as backups of the NTDS.DIT database of Active Directory. If found, they can copy the database offsite and run an offline tool to compromise accounts in the organization further.

The ""Account is sensitive and cannot be delegated"" setting
Microsoft has provided a setting in Active Directory Domain Services that can help mitigate the issue. In addition, an Active Directory setting is recommended to be enabled for privileged accounts in the domain. The setting is ""account is sensitive and cannot be delegated"" within the account properties.
When configured, this setting strips the delegate-level token from the user, removing the user credentials. When configured, the logon becomes an ANONYMOUS login with no resource permissions.

[cid:image001.png@01DAD365.2E5215A0]



Dusty Grayson
Sr. Support Engineer
Phone: 1-949-407-5125 | Toll-free: 888-638-9749
____________________ __________
Cybersecurity That Works for You.
6160 Warren Parkway, Suite 100,Frisco, TX 75034
www.netwrix.com<https://urldefense.com/v3/__http:/www.netwrix.com__;!!CiF3mHgEawk!E6x73CeNirBEZg3CqSsJjAHyCDawVG48U3Q-JmmppBOujNws8dJtCzrPQny1mG3LLXdwN9_O1Hm6NRH7wL7zTEY6Eg$>

*****Please note Support communication changes*****
Directly emailing Support Engineers is likely to result in oversight, as they do not handle cases through email correspondence.
It is recommended to use the Support Portal for appropriate communication channels. https://www.netwrix.com/sign_in.html?rf=my_tickets.html<https://urldefense.com/v3/__https:/www.netwrix.com/sign_in.html?rf=my_tickets.html__;!!CiF3mHgEawk!E6x73CeNirBEZg3CqSsJjAHyCDawVG48U3Q-JmmppBOujNws8dJtCzrPQny1mG3LLXdwN9_O1Hm6NRH7wL6gPcd4bA$>

Emailing into support@stealthbits.com<mailto:support@stealthbits.com> has been disabled as well.


--------------- Original Message ---------------
From: Robert Parsons [robert.parsons@optiv.com]
Sent: 7/10/2024 5:20 PM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Subject: RE: Netwrix Support Ticket #414656 - - weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]

ref:_00D7091pB._500Q000Ctd8H:ref


Thanks Dusty, those are good general info links and I didn't have most of them in my bookmarks already!

What I'm looking for here in this case won't be covered by those (unless I completely missed it in scanning thru them), because the question relates specifically to NEA and what ""delegatable admin"" means in the application there (specifically the weak passwords job report).

After some additional digging and guessing, I have to think that it means an account has to meet two criteria:

  1.  The item ""Account is sensitive and cannot be delegated"" is *NOT* set on a user (AD users and computers > Account tab)
  2.  The user *IS* a member of some sort of administrative group, perhaps such as Domain Admins

So:

  1.  Can we get confirmation if the above criteria is what the weak password means when it says an account is a ""delegatable admin"" and
  2.  If that is what it means, what are the list of groups that count as considering the account an admin?  Additionally are there any other conditions besides group membership that would make an account be considered an admin for the purposes of this question?

I realize that this question is likely to require code review unless someone has significantly more documentation than you and I have come across so far.  Please raise the question to development, which is sounds like you already may have done.

As always, I appreciate all your help with my questions.  I know that can be the weird ones most of the time!


Best regards,

Robert Parsons  |  CISSP, Security+
Sr. Consultant II - Data Governance and Protection
robert.parsons@optiv.com<mailto:robert.parsons@optiv.com>           www.optiv.com<https://urldefense.proofpoint.com/v2/url?u=http-3A__www.optiv.com_&d=DwMFAg&c=TxO9TIZxM1NIgbR_44vEiALc2o8uaxixBRc1BtwrN08&r=wTusx-C4z2FLLedAEYQA2ozDXRjnwAwY5MOqtGX_LBk&m=p9KOsVL_mUfnoCxj5P_b8DcgXpb1Ej1lTcI7g9q-VEU&s=drEl314f8l2OncEDuCSZoOe-bqerVSqKZID1ECMT_9E&e=>
[cid:image002.png@01DAD365.2E5215A0]






From: Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Sent: Wednesday, July 10, 2024 1:42 PM
To: Robert Parsons <robert.parsons@optiv.com<mailto:robert.parsons@optiv.com>>
Subject: RE: Netwrix Support Ticket #414656 - - weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]


Robert,

Here is some non Dev feed back:

Active Directory: How to View or Delete Delegated Permissions
https://learn.microsoft.com/en-us/archive/technet-wiki/6477.active-directory-how-to-view-or-delete-delegated-permissions<https://urldefense.com/v3/__https:/learn.microsoft.com/en-us/archive/technet-wiki/6477.active-directory-how-to-view-or-delete-delegated-permissions__;!!CiF3mHgEawk!H-Ix2T-qP8iVe-ICd-luDBuidIHsm_WdHHKjUhHdHOr7RRo9zinwYSwEaXNJsVILQ1Sc2bK8w3aW1vzsb2Iq-hyRlQ$>

Detecting Delegated Permissions in Active Directory
https://blog.netwrix.com/2016/10/27/detecting-delegated-permissions-in-active-directory/<https://urldefense.com/v3/__https:/blog.netwrix.com/2016/10/27/detecting-delegated-permissions-in-active-directory/__;!!CiF3mHgEawk!H-Ix2T-qP8iVe-ICd-luDBuidIHsm_WdHHKjUhHdHOr7RRo9zinwYSwEaXNJsVILQ1Sc2bK8w3aW1vzsb2I8l1NDPw$>

Active Directory Delegation Overview
https://blog.netwrix.com/2022/11/14/active_directory_delegation/#:~:text=How%20do%20I%20check%20delegation%20in%20Active%20Directory%3F,the%20Security%20tab%20to%20view%20the%20delegated%20permissions<https://urldefense.com/v3/__https:/blog.netwrix.com/2022/11/14/active_directory_delegation/*:*:text=How*20do*20I*20check*20delegation*20in*20Active*20Directory*3F,the*20Security*20tab*20to*20view*20the*20delegated*20permissions__;I34lJSUlJSUlJSUlJSUlJSU!!CiF3mHgEawk!H-Ix2T-qP8iVe-ICd-luDBuidIHsm_WdHHKjUhHdHOr7RRo9zinwYSwEaXNJsVILQ1Sc2bK8w3aW1vzsb2LlNvYwTA$>

Dusty Grayson
Sr. Support Engineer
Phone: 1-949-407-5125 | Toll-free: 888-638-9749
____________________ __________
Cybersecurity That Works for You.
6160 Warren Parkway, Suite 100,Frisco, TX 75034
www.netwrix.com<https://urldefense.com/v3/__http:/www.netwrix.com__;!!CiF3mHgEawk!H-Ix2T-qP8iVe-ICd-luDBuidIHsm_WdHHKjUhHdHOr7RRo9zinwYSwEaXNJsVILQ1Sc2bK8w3aW1vzsb2JOguykxw$>

*****Please note Support communication changes*****
Directly emailing Support Engineers is likely to result in oversight, as they do not handle cases through email correspondence.
It is recommended to use the Support Portal for appropriate communication channels. https://www.netwrix.com/sign_in.html?rf=my_tickets.html<https://urldefense.com/v3/__https:/www.netwrix.com/sign_in.html?rf=my_tickets.html__;!!CiF3mHgEawk!H-Ix2T-qP8iVe-ICd-luDBuidIHsm_WdHHKjUhHdHOr7RRo9zinwYSwEaXNJsVILQ1Sc2bK8w3aW1vzsb2IL6XWMqw$>

Emailing into support@stealthbits.com<mailto:support@stealthbits.com> has been disabled as well.


--------------- Original Message ---------------
From: Robert Parsons [robert.parsons@optiv.com]
Sent: 7/10/2024 2:37 PM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Subject: RE: Netwrix Support Ticket #414656 - ref:_00D7091pB._500Q000Ctd8H:ref - weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]

ref:_00D7091pB._500Q000Ctd8H:ref


Thanks Dusty.  The customer is Trintech International.  I don't have remote access so I can't get the version numbers, but I don't think that info will affect my questions.

This question is specifically about what the Weak Passwords job checks to determine that someone is a ""delegable admin"".  The link to the weak passwords job documentation only gives this info:

  1.  Delegable Admins - Administrator account is allowed to be delegated to a service
That isn't enough info, hence the inquiry.

My question about the two attributes is because I thought they might be related to the condition checked by the weak passwords job.  I'm not asking about the User Delegation job, so if those attributes only come from there and are in no way related to the weak passwords job, that's all I would need confirmation on with respect to those attributes.

-Robert


From: Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Sent: Wednesday, July 10, 2024 10:49 AM
To: Robert Parsons <robert.parsons@optiv.com<mailto:robert.parsons@optiv.com>>
Subject: weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]

Robert,

Thank you for reaching out to support.

Please note your customer so we can correctly update the ticket.

To update/confirm our Technical Support Notes & start the investigation, could we get the text output (copy&past) from the following ADMIN PowerShell ISE script block on the systems that are running Netwrix/Stealth Server applications?

Clear-Host  # Clears the console window for better readability.
#Netwrix/Stealth, PostgreSQL, Python application versions:
Get-CimInstance -Class Win32_Product |
Where-Object {($_.Name -Like ""Stealth*"" -or $_.Name -like ""Netwrix*"" -or $_.Name -like ""*Postg*"" -or ` $_.Name -like ""Python*"")} -ErrorAction SilentlyContinue |
Sort-Object | Format-Table Name,Version,InstallDate -AutoSize

#Netwrix Enterprise Auditor (NEA) formally StealthAUDIT (SA) install path
$env:SAINSTALLDIR

#Netwrix Access Information Center (AIC) formally StealthAUDIT Access Information Center (AIC) install path
(Get-ItemProperty -Path ""HKLM:SYSTEMCurrentControlSetServicesAccessInformationCenter""-ErrorAction SilentlyContinue).ImagePath.Replace(""`"""", """").Replace(""BinAccessInformationCenter.Service.exe"", """")


Please note the following:
Netwrix Enterprise Auditor v11.6 > Solutions > Active Directory Solution > Active Directory Job Group > 2.Users Job Group > AD_WeakPasswords Job:
Delegable Admins - Administrator account is allowed to be delegated to a service
https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_WeakPasswords.htm<https://urldefense.com/v3/__https:/helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_WeakPasswords.htm__;!!CiF3mHgEawk!HAqCDE-MZ68EX-Fo0A3cg-_Sx8P3fYOFjTskbArfiNFiEL3ddkMnvYUqJ7nLubHef80lWCpLDxgPDQYe6roNmDWJ6w$>

Netwrix Enterprise Auditor v11.6 > Solutions > Active Directory Solution > 2.1Jsers Job Group > AD_UserDelegation Job
The AD_Delegation Job highlights user accounts which are trusted for delegation.
https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_UserDelegation.htm<https://urldefense.com/v3/__https:/helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_UserDelegation.htm__;!!CiF3mHgEawk!HAqCDE-MZ68EX-Fo0A3cg-_Sx8P3fYOFjTskbArfiNFiEL3ddkMnvYUqJ7nLubHef80lWCpLDxgPDQYe6rqSJW8sPw$>

Checking that this is the correct correlation, as well as any options to directly check within AD?

Thank You for your time.

Dusty Grayson
Sr. Support Engineer
Phone: 1-949-407-5125 | Toll-free: 888-638-9749
____________________ __________
Cybersecurity That Works for You.
6160 Warren Parkway, Suite 100,Frisco, TX 75034
www.netwrix.com<https://urldefense.com/v3/__http:/www.netwrix.com__;!!CiF3mHgEawk!HAqCDE-MZ68EX-Fo0A3cg-_Sx8P3fYOFjTskbArfiNFiEL3ddkMnvYUqJ7nLubHef80lWCpLDxgPDQYe6rplu9vtlw$>

*****Please note Support communication changes*****
Directly emailing Support Engineers is likely to result in oversight, as they do not handle cases through email correspondence.
It is recommended to use the Support Portal for appropriate communication channels. https://www.netwrix.com/sign_in.html?rf=my_tickets.html<https://urldefense.com/v3/__https:/www.netwrix.com/sign_in.html?rf=my_tickets.html__;!!CiF3mHgEawk!HAqCDE-MZ68EX-Fo0A3cg-_Sx8P3fYOFjTskbArfiNFiEL3ddkMnvYUqJ7nLubHef80lWCpLDxgPDQYe6rrx50432g$>

Emailing into support@stealthbits.com<mailto:support@stealthbits.com> has been disabled as well.

ref:!00D70091pB.!500Qk0Ctd8H:ref","RE: Netwrix Support Ticket #414656 -  - weak passwords job - what exactly is ""trusted for delegation""    [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]","robert.parsons@optiv.com","Robert Parsons","techsupport@netwrix.com","","","true","2024-07-11T14:37:30.000Z","true"
"02sQk00000CSuEyIAL","500Qk00000Ctd8HIAR","2024-07-11T14:46:32.000Z","2024-07-11T14:46:32.000Z","Robert,

Thank You for the update, I will close out this ticket as noted.

We have 30days to reopen once the closure email is received.

To reopen we can just reply to that email to bring the case back into my queue.

Following this email, you will receive an automated confirmation that the case is closed, along with the ability to re-open the case if any related errors return. 

Feel free to leave any feedback via the survey link.

Have a great weekend.

Again, thank You for your time.

Dusty Grayson
Sr. Support Engineer
Phone: 1-949-407-5125 | Toll-free: 888-638-9749
____________________ __________
Cybersecurity That Works for You.
6160 Warren Parkway, Suite 100,Frisco, TX 75034
www.netwrix.com

*****Please note Support communication changes*****
Directly emailing Support Engineers is likely to result in oversight, as they do not handle cases through email correspondence.
It is recommended to use the Support Portal for appropriate communication channels. https://www.netwrix.com/sign_in.html?rf=my_tickets.html

Emailing into support@stealthbits.com has been disabled as well.


--------------- Original Message ---------------
From: Robert Parsons [robert.parsons@optiv.com]
Sent: 7/11/2024 10:37 AM
To: techsupport@netwrix.com
Subject: RE: Netwrix Support Ticket #414656 - - weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]

ref:_00D7091pB._500Q000Ctd8H:ref



Thanks Dusty!  This is the info I needed.  The ticket can be closed, and thanks for your help.

 

-Robert

 



From: Netwrix Support <techsupport@netwrix.com>
Sent: Thursday, July 11, 2024 6:27 AM
To: Robert Parsons <robert.parsons@optiv.com>
Subject: RE: Netwrix Support Ticket #414656 - - weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]



 

Robert,

Here is what Dev had to note for our inquiry.

Essentially accounts that are administrators (i believe it just checks admincount = 1) and are not marked as 'sensitive and cannot be delegated' Admin accounts should not be delegated as they can be abused in a ton of ways, that is why that setting in AD exists
 https://specopssoft.com/blog/securing-authentication-tokens-by-preventing-delegation-of-admin-accounts/

Securing authentication tokens by preventing delegation of admin accounts
Recommended settings in Active Directory that mitigate the risk associated with account delegation on insecure computers and administrator accounts.
 
Security implications of delegable admins
Using freely available tools, attackers only need to compromise a client and access a standard account. Once they have their foot in the door, they can use tools like Meterpreter to list the available delegate tokens. Privileged accounts with delegation tokens available can lead to the attacker being able to steal a privileged user token, such as a domain admin account. Once the attacker has a domain admin-level account, the possibilities are endless.
Once they have high-level privileged accounts, they often go after backup files that may contain prized targets, such as backups of the NTDS.DIT database of Active Directory. If found, they can copy the database offsite and run an offline tool to compromise accounts in the organization further.
 
The “Account is sensitive and cannot be delegated” setting
Microsoft has provided a setting in Active Directory Domain Services that can help mitigate the issue. In addition, an Active Directory setting is recommended to be enabled for privileged accounts in the domain. The setting is “account is sensitive and cannot be delegated” within the account properties.
When configured, this setting strips the delegate-level token from the user, removing the user credentials. When configured, the logon becomes an ANONYMOUS login with no resource permissions.





Dusty Grayson
Sr. Support Engineer
Phone: 1-949-407-5125 | Toll-free: 888-638-9749
____________________ __________
Cybersecurity That Works for You.
6160 Warren Parkway, Suite 100,Frisco, TX 75034
www.netwrix.com

*****Please note Support communication changes*****
Directly emailing Support Engineers is likely to result in oversight, as they do not handle cases through email correspondence.
It is recommended to use the Support Portal for appropriate communication channels.  https://www.netwrix.com/sign_in.html?rf=my_tickets.html

Emailing into support@stealthbits.com has been disabled as well.


--------------- Original Message ---------------
From: Robert Parsons [robert.parsons@optiv.com]
Sent: 7/10/2024 5:20 PM
To: techsupport@netwrix.com
Subject: RE: Netwrix Support Ticket #414656 - - weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]

ref:_00D7091pB._500Q000Ctd8H:ref

 


Thanks Dusty, those are good general info links and I didn’t have most of them in my bookmarks already!

 

What I’m looking for here in this case won’t be covered by those (unless I completely missed it in scanning thru them), because the question relates specifically to NEA and what “delegatable admin” means in the application there (specifically the weak passwords job report).   

 

After some additional digging and guessing, I have to think that it means an account has to meet two criteria:


	The item “Account is sensitive and cannot be delegated” is *NOT* set on a user (AD users and computers > Account tab)
	The user *IS* a member of some sort of administrative group, perhaps such as Domain Admins


 

So:


	Can we get confirmation if the above criteria is what the weak password means when it says an account is a “delegatable admin” and
	If that is what it means, what are the list of groups that count as considering the account an admin?  Additionally are there any other conditions besides group membership that would make an account be considered an admin for the purposes of this question?


 

I realize that this question is likely to require code review unless someone has significantly more documentation than you and I have come across so far.  Please raise the question to development, which is sounds like you already may have done.

 

As always, I appreciate all your help with my questions.  I know that can be the weird ones most of the time!

 

 

Best regards,

 

Robert Parsons  |  CISSP, Security+

Sr. Consultant II - Data Governance and Protection

robert.parsons@optiv.com            www.optiv.com



 

 

 

 

 

 



From: Netwrix Support <techsupport@netwrix.com>
Sent: Wednesday, July 10, 2024 1:42 PM
To: Robert Parsons <robert.parsons@optiv.com>
Subject: RE: Netwrix Support Ticket #414656 - - weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]



 

Robert,

Here is some non Dev feed back:

Active Directory: How to View or Delete Delegated Permissions
https://learn.microsoft.com/en-us/archive/technet-wiki/6477.active-directory-how-to-view-or-delete-delegated-permissions      

Detecting Delegated Permissions in Active Directory
https://blog.netwrix.com/2016/10/27/detecting-delegated-permissions-in-active-directory/  

Active Directory Delegation Overview
https://blog.netwrix.com/2022/11/14/active_directory_delegation/#:~:text=How%20do%20I%20check%20delegation%20in%20Active%20Directory%3F,the%20Security%20tab%20to%20view%20the%20delegated%20permissions  

Dusty Grayson
Sr. Support Engineer
Phone: 1-949-407-5125 | Toll-free: 888-638-9749
____________________ __________
Cybersecurity That Works for You.
6160 Warren Parkway, Suite 100,Frisco, TX 75034
www.netwrix.com

*****Please note Support communication changes*****
Directly emailing Support Engineers is likely to result in oversight, as they do not handle cases through email correspondence.
It is recommended to use the Support Portal for appropriate communication channels.  https://www.netwrix.com/sign_in.html?rf=my_tickets.html

Emailing into support@stealthbits.com has been disabled as well.


--------------- Original Message ---------------
From: Robert Parsons [robert.parsons@optiv.com]
Sent: 7/10/2024 2:37 PM
To: techsupport@netwrix.com
Subject: RE: Netwrix Support Ticket #414656 - ref:_00D7091pB._500Q000Ctd8H:ref - weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]

ref:_00D7091pB._500Q000Ctd8H:ref

 


Thanks Dusty.  The customer is Trintech International.  I don’t have remote access so I can’t get the version numbers, but I don’t think that info will affect my questions.

 

This question is specifically about what the Weak Passwords job checks to determine that someone is a “delegable admin”.  The link to the weak passwords job documentation only gives this info:


	Delegable Admins – Administrator account is allowed to be delegated to a service


That isn’t enough info, hence the inquiry.

 

My question about the two attributes is because I thought they might be related to the condition checked by the weak passwords job.  I’m not asking about the User Delegation job, so if those attributes only come from there and are in no way related to the weak passwords job, that’s all I would need confirmation on with respect to those attributes.

 

-Robert

 

 



From: Netwrix Support <techsupport@netwrix.com>
Sent: Wednesday, July 10, 2024 10:49 AM
To: Robert Parsons <robert.parsons@optiv.com>
Subject: weak passwords job - what exactly is ""trusted for delegation"" [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]



 

Robert,

Thank you for reaching out to support. 

Please note your customer so we can correctly update the ticket.

To update/confirm our Technical Support Notes & start the investigation, could we get the text output (copy&past) from the following ADMIN PowerShell ISE script block on the systems that are running Netwrix/Stealth Server applications?

Clear-Host  # Clears the console window for better readability. 
#Netwrix/Stealth, PostgreSQL, Python application versions:
Get-CimInstance -Class Win32_Product |
Where-Object {($_.Name -Like ""Stealth*"" -or $_.Name -like ""Netwrix*"" -or $_.Name -like ""*Postg*"" -or ` $_.Name -like ""Python*"")} -ErrorAction SilentlyContinue |
Sort-Object | Format-Table Name,Version,InstallDate -AutoSize 

#Netwrix Enterprise Auditor (NEA) formally StealthAUDIT (SA) install path
$env:SAINSTALLDIR 

#Netwrix Access Information Center (AIC) formally StealthAUDIT Access Information Center (AIC) install path
(Get-ItemProperty -Path ""HKLM:SYSTEMCurrentControlSetServicesAccessInformationCenter""-ErrorAction SilentlyContinue).ImagePath.Replace(""`"""", """").Replace(""BinAccessInformationCenter.Service.exe"", """")


Please note the following:
Netwrix Enterprise Auditor v11.6 > Solutions > Active Directory Solution > Active Directory Job Group > 2.Users Job Group > AD_WeakPasswords Job:
Delegable Admins – Administrator account is allowed to be delegated to a service
https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_WeakPasswords.htm

Netwrix Enterprise Auditor v11.6 > Solutions > Active Directory Solution > 2.1Jsers Job Group > AD_UserDelegation Job
The AD_Delegation Job highlights user accounts which are trusted for delegation.
https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Solutions/ActiveDirectory/Users/AD_UserDelegation.htm

Checking that this is the correct correlation, as well as any options to directly check within AD?

Thank You for your time.

Dusty Grayson
Sr. Support Engineer
Phone: 1-949-407-5125 | Toll-free: 888-638-9749
____________________ __________
Cybersecurity That Works for You.
6160 Warren Parkway, Suite 100,Frisco, TX 75034
www.netwrix.com

*****Please note Support communication changes*****
Directly emailing Support Engineers is likely to result in oversight, as they do not handle cases through email correspondence.
It is recommended to use the Support Portal for appropriate communication channels.  https://www.netwrix.com/sign_in.html?rf=my_tickets.html

Emailing into support@stealthbits.com has been disabled as well.

ref:!00D70091pB.!500Qk0Ctd8H:ref","RE: Netwrix Support Ticket #414656 -  - weak passwords job - what exactly is ""trusted for delegation""    [ ref:!00D70091pB.!500Qk0Ctd8H:ref ]","techsupport@netwrix.com","Netwrix Support","robert.parsons@optiv.com","","","true","2024-07-11T14:46:31.000Z","true"
