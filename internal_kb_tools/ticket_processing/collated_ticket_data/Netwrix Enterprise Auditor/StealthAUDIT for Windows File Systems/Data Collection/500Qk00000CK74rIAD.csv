"Id","CaseNumber","Ticket_Record_Type_Name__c","Subject","Description","DevOps_Steps_to_Reproduce__c","What_We_Know__c","Next_Steps__c","Solution_Comment__c","Issue_Type__c","Ticket_Owner_Name__c","Ticket_Type__c","Platform__c","Collector_Code__c","Feature__c","Product_Version__c","Build_Number__c","Age__c","Status","Account_Name__c","Contact_Name__c","CreatedDate","ClosedDate"
"500Qk00000CK74rIAD","00413095","Support Ticket","FSAA Permissions Scan Errors","We are seeing errors in our FSAA Permissions scanning job. Please help us to resolve them.

Below is an example of the error we are seeing.

Error message from FSAA Permissions > 1-FSAA System Scans Job > Messages:

Stealthbits.StealthAUDIT.DataCollectors.FSAA.FSAAException: Error removing PRODSQLA428WDFW from tier 1 database: Failed to remove Host ID: 2489 from table SA_FSAA_Trustees ---> Stealthbits.StealthAUDIT.DataCollectors.FSAA.FSAAException: Failed to remove Host ID: 2489 from table SA_FSAA_Trustees ---> System.Data.SqlClient.SqlException: Cannot continue the execution because the session is in the kill state. A severe error occurred on the current command. The results, if any, should be discarded. The statement has been terminated. at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction) at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction) at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose) at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady) at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted) at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest) at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry) at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry) at System.Data.SqlClient.SqlCommand.ExecuteNonQuery() at Dapper.SqlMapper.ExecuteCommand(IDbConnection cnn, CommandDefinition& command, Action`2 paramReader) at Dapper.SqlMapper.ExecuteImpl(IDbConnection cnn, CommandDefinition& command) at Stealthbits.StealthAUDIT.DataCollectors.FSAA.Tier1.RemoveHostFromTier1Table(Int32 hostId, String tableName, String hostColumn, Int64& totalRowsAffected) --- End of inner exception stack trace --- at Stealthbits.StealthAUDIT.DataCollectors.FSAA.Tier1.RemoveHostFromTier1Table(Int32 hostId, String tableName, String hostColumn, Int64& totalRowsAffected) at Stealthbits.StealthAUDIT.DataCollectors.FSAA.RemoveFSAAHostTask.InternalProcessRecord() --- End of inner exception stack trace --- at Stealthbits.StealthAUDIT.DataCollectors.FSAA.RemoveFSAAHostTask.InternalProcessRecord() at Stealthbits.StealthAUDIT.DataCollectors.Tasks.Task.StartExecute()","","","","Confirmed that the current version of Stealth application(s) running in the Environment:

Netwrix Enterprise Auditor (NEA) formally StealthAUDIT (SA)                                                                            11.5.0.177
Netwrix Access Information Center (AIC) formally StealthAUDIT Access Information Center (AIC)                  11.5.0.122

Corrected the FSAA job was somehow set top the FSAC scan settings.

\eagle.usaa.comidtn_test test_A2019_share    which relates to    \testnas2_2.usaa.comusaa_test test_A2019_share

We found that the needed host was not part of the expected host list, to temporarily adjust we added the needed host to the Jobs Individual host table to include the original Netapp By IP host list.

Kicked off the needed FSAA job once complete we will need to run the Jobs > FileSystem > Reporting scheduled task.

Contact last comment:
Success! After the GROUP_FileSystem job group completed, the AIC now has scan data for the share ðŸ™‚. So, I think having the Storage team add the accounts to the Power Users and Backup Operators local groups for the TESTNAS2_2 host and then running the GROUP_FileSystem job did the trick.","Incorrect configuration: Netwrix product","Dusty Grayson","","Netwrix Enterprise Auditor","StealthAUDIT for Windows File Systems","Data Collection","11.5","177","20.0","Closed - Resolved","USAA","Rich Harbaugh","2024-06-26T13:53:57.000Z","2024-07-16T12:49:25.000Z"
