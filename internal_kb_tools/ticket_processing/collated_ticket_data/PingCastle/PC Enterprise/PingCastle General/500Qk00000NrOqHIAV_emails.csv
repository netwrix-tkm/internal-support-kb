"Id","ParentId","CreatedDate","LastModifiedDate","TextBody","Subject","FromAddress","FromName","ToAddress","CcAddress","BccAddress","HasAttachment","MessageDate","IsExternallyVisible"
"02sQk00000NY9DZIA1","500Qk00000NrOqHIAV","2025-04-09T13:19:12.000Z","2025-04-09T13:19:12.000Z","Hello Maltaverne,

Thank you for contacting Netwrix Support. Please note that I will be assisting you with your query regarding custom rules in PingCastle. I will be getting back to you with updates on this. Meanwhile if you have any additional questions and concerns please feel free to add your comments.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation
ref:!00D70091pB.!500Qk0NrOqH:ref","How to use custom rules on standalone pingcastle client    [ ref:!00D70091pB.!500Qk0NrOqH:ref ]","techsupport@netwrix.com","Netwrix Support","julien.maltaverne@thalesgroup.com","kyle.vogley@netwrix.com","shaheryar.ali.tahir@netwrix.com; brandon.west@netwrix.com","false","2025-04-09T13:19:10.000Z","true"
"02sQk00000NYI8cIAH","500Qk00000NrOqHIAV","2025-04-09T13:29:35.000Z","2025-04-09T15:55:09.000Z","ref:_00D7091pB._500Q000NrOqH:ref

Hello

Thank you for contacting me.
You can find bellow the discussion in the Support Ticket 439303.

Best regards
Julien
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 9:42 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref


Emiliano

I don’t use --api-endpoint.
But I’ve checked my PingCastle version. It’s an auditor version. It seems that “custom rules” are only functional on pro version.

I try add a maturitylevel section but It’s not good….

<customRulesSettings>

    <CustomRules>

      <!--Risk P-DsHeuristicsDoListObject-->

      <CustomRule RiskId=""P-DsHeuristicsDoListObject"">

               <MaturityLevel MaturityLevel=”5”/>

      </CustomRule>

    </CustomRules>

  </customRulesSettings>

Regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : lundi 24 mars 2025 13:32
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : LORACH Benoit <benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>>
Objet : RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

Hi Julien,

The web UI is the web User Interface.

Then, let me ask you something, are you using the --api-endpoint ? If so, it could be overwriting the rule that you are trying to add and that's why is not being modified.
Please let me know that, so I can further investigate to assist you.

Thank you!
Regards,

Emiliano Kraiñuk
Technical Support Engineer
1-949-407-5125
____________________ __________
Cybersecurity That Works for You

Netwrix | 6160 Warren Parkway, Suite 100, Frisco, TX 75034
www.netwrix.com<http://www.netwrix.com>


--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 7:33 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref


Hello Emiliano

I’ve tried to add the custom rule but the result is same.
Sorry but vould you explain me what mean Web UI ?

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>




Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com>
Envoyé : mercredi 9 avril 2025 15:19
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello Maltaverne,

Thank you for contacting Netwrix Support. Please note that I will be assisting you with your query regarding custom rules in PingCastle. I will be getting back to you with updates on this. Meanwhile if you have any additional questions and concerns please feel free to add your comments.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation

ref:!00D70091pB.!500Qk0NrOqH:ref","RE: Netwrix Support Ticket #441448 - ref:_00D7091pB._500Q000NrOqH:ref - How to use custom rules on standalone pingcastle client    [ ref:!00D70091pB.!500Qk0NrOqH:ref ]","julien.maltaverne@thalesgroup.com","MALTAVERNE Julien","techsupport@netwrix.com","kyle.vogley@netwrix.com; benoit.lorach@thalesgroup.com","","true","2025-04-09T13:29:19.000Z","true"
"02sQk00000NY60zIAD","500Qk00000NrOqHIAV","2025-04-09T13:36:36.000Z","2025-04-09T15:54:58.000Z","ref:_00D7091pB._500Q000NrOqH:ref

Another information :

I’ve tried to modify custom rules by using the values defined below :

namespace PingCastle.Healthcheck.Rules
{
[RuleModel(""P-DsHeuristicsDoListObject"", RiskRuleCategory.PrivilegedAccounts, RiskModelCategory.ACLCheck)]
[RuleComputation(RuleComputationType.TriggerOnPresence, 0)]
[RuleIntroducedIn(2, 7)]
[RuleMaturityLevel(2)]
[RuleMitreAttackMitigation(MitreAttackMitigation.ActiveDirectoryConfiguration)]
public class HeatlcheckRulePrivilegedDsHeuristicsDoListObject : RuleBase<HealthcheckData>
{
protected override int? AnalyzeDataNew(HealthcheckData healthcheckData)
{
if (healthcheckData.DSHeuristics != null && healthcheckData.DSHeuristics.Length >= 3 && healthcheckData.DSHeuristics.Substring(2, 1) != ""0"")
{
return 1;
}
return 0;
}
}
}

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : MALTAVERNE Julien
Envoyé : mercredi 9 avril 2025 15:29
À : 'Netwrix Support' <techsupport@netwrix.com>
Cc : kyle.vogley@netwrix.com; LORACH Benoit <benoit.lorach@thalesgroup.com>
Objet : RE: How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello

Thank you for contacting me.
You can find bellow the discussion in the Support Ticket 439303.

Best regards
Julien
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 9:42 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref


Emiliano

I don’t use --api-endpoint.
But I’ve checked my PingCastle version. It’s an auditor version. It seems that “custom rules” are only functional on pro version.

I try add a maturitylevel section but It’s not good….

<customRulesSettings>

    <CustomRules>

      <!--Risk P-DsHeuristicsDoListObject-->

      <CustomRule RiskId=""P-DsHeuristicsDoListObject"">

               <MaturityLevel MaturityLevel=”5”/>

      </CustomRule>

    </CustomRules>

  </customRulesSettings>

Regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : lundi 24 mars 2025 13:32
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : LORACH Benoit <benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>>
Objet : RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

Hi Julien,

The web UI is the web User Interface.

Then, let me ask you something, are you using the --api-endpoint ? If so, it could be overwriting the rule that you are trying to add and that's why is not being modified.
Please let me know that, so I can further investigate to assist you.

Thank you!
Regards,

Emiliano Kraiñuk
Technical Support Engineer
1-949-407-5125
____________________ __________
Cybersecurity That Works for You

Netwrix | 6160 Warren Parkway, Suite 100, Frisco, TX 75034
www.netwrix.com<http://www.netwrix.com>


--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 7:33 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref


Hello Emiliano

I’ve tried to add the custom rule but the result is same.
Sorry but vould you explain me what mean Web UI ?

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>




Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : mercredi 9 avril 2025 15:19
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Objet : How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello Maltaverne,

Thank you for contacting Netwrix Support. Please note that I will be assisting you with your query regarding custom rules in PingCastle. I will be getting back to you with updates on this. Meanwhile if you have any additional questions and concerns please feel free to add your comments.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation

ref:!00D70091pB.!500Qk0NrOqH:ref","RE: Netwrix Support Ticket #441448 - ref:_00D7091pB._500Q000NrOqH:ref - How to use custom rules on standalone pingcastle client    [ ref:!00D70091pB.!500Qk0NrOqH:ref ]","julien.maltaverne@thalesgroup.com","MALTAVERNE Julien","techsupport@netwrix.com","kyle.vogley@netwrix.com; benoit.lorach@thalesgroup.com","","true","2025-04-09T13:36:21.000Z","true"
"02sQk00000NaiTWIAZ","500Qk00000NrOqHIAV","2025-04-10T10:28:57.000Z","2025-04-10T10:28:57.000Z","Hello Julien!

Please refer to the following documentation and let me know if this helps:

Using rule customization in PingCastle Pro and Enterprise

Rule customization is a paid for feature and is easily configurable in the Professional and Enterprise editions. Customers can use this if they disagree with the rules we set and want to change them themselves but also serves as a useful way to understand the rule customizations visually.

To modify custom rules users can follow this process:

 - Login to the Web Application
 - Navigate to Configuration → Custom Rules 
 - Click on New Customization 
 - Select the Rule ID that needs to be customized
 - Click on  Next 
 - Use the Maturity Level dropdown to change the maturity level for a rule. 
   - This will affect the “Maturity Assessment” section of the report
 - Rule (Scoring) customization options
   -  Append Rule - This adds a new rule to the current list of rules used for scoring
   -  Load Original Rules - This loads the rules specified by Netwrix and can be used to understand the logic and slightly adjust things.
   -  Clear - Reverts back to the Netwrix specified scoring


Example

In this example the A-KRBTGT rule will be modified so that we get a score of 5 points if its password is over 42 days old and then we double it to 10 points when its password is older than a year but we will leave it in the Level 2 Maturity Assessment




Running PingCastle using the custom rules

Here we will go through how to use PingCastle.exe with the custom rules.

Using the API

Running PingCastle.exe using the api options will automatically download the custom rules from the PingCastle Web Application.
 

`PingCastle.exe --HealthCheck --Server DC.domain.local --api-endpoint https://pc.domain.local --api-key blahblahblah`

This happens via the AgentController and the GetSettings API call.


Using the PingCastle.exe.config

For disconnected networks that cannot contact the PingCastle web application it is possible to use the PingCastle.exe.config to specify custom rules. You still specify them in the Web UI then click on download. You will then be presented with the XML configuration needed and you can copy that into the PingCastle.exe.config.



NOTE: You only really need to copy the <CustomRulesSettings> tag and overwrite any existing one in the PingCastle.exe.config. The <configSections> should already be in the file.



 
You can see here how this may end up looking in an actual PingCastle.exe.config.




Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation






--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/9/2025 9:36 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com; benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #441448 - ref:_00D7091pB._500Q000NrOqH:ref - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref



Another information :

 

I’ve tried to modify custom rules by using the values defined below :

namespace PingCastle.Healthcheck.Rules
{
[RuleModel(""P-DsHeuristicsDoListObject"", RiskRuleCategory.PrivilegedAccounts, RiskModelCategory.ACLCheck)]
[RuleComputation(RuleComputationType.TriggerOnPresence, 0)]
[RuleIntroducedIn(2, 7)]
[RuleMaturityLevel(2)]
[RuleMitreAttackMitigation(MitreAttackMitigation.ActiveDirectoryConfiguration)]
public class HeatlcheckRulePrivilegedDsHeuristicsDoListObject : RuleBase<HealthcheckData>
{
protected override int? AnalyzeDataNew(HealthcheckData healthcheckData)
{
if (healthcheckData.DSHeuristics != null && healthcheckData.DSHeuristics.Length >= 3 && healthcheckData.DSHeuristics.Substring(2, 1) != ""0"")
{
return 1;
}
return 0;
}
}
}

 

Best regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : MALTAVERNE Julien
Envoyé : mercredi 9 avril 2025 15:29
À : 'Netwrix Support' <techsupport@netwrix.com>
Cc : kyle.vogley@netwrix.com; LORACH Benoit <benoit.lorach@thalesgroup.com>
Objet : RE: How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello

 

Thank you for contacting me.
You can find bellow the discussion in the Support Ticket 439303.

 

Best regards 

Julien

From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 9:42 AM
To: techsupport@netwrix.com
Cc: benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref

 

Emiliano

 

I don’t use --api-endpoint.

But I’ve checked my PingCastle version. It’s an auditor version. It seems that “custom rules” are only functional on pro version.

 

I try add a maturitylevel section but It’s not good….

 

<customRulesSettings>

 

    <CustomRules>

 

      <!--Risk P-DsHeuristicsDoListObject-->

 

      <CustomRule RiskId=""P-DsHeuristicsDoListObject"">

 

               <MaturityLevel MaturityLevel=”5”/>

 

      </CustomRule>

 

    </CustomRules>

 

  </customRulesSettings>

 

Regards

Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 

 

De : Netwrix Support <techsupport@netwrix.com>
Envoyé : lundi 24 mars 2025 13:32
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : LORACH Benoit <benoit.lorach@thalesgroup.com>
Objet : RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

 

Hi Julien,

The web UI is the web User Interface.

Then, let me ask you something, are you using the --api-endpoint ? If so, it could be overwriting the rule that you are trying to add and that's why is not being modified.
Please let me know that, so I can further investigate to assist you.

Thank you!
Regards,

Emiliano Kraiñuk
Technical Support Engineer
1-949-407-5125
____________________ __________
Cybersecurity That Works for You

Netwrix | 6160 Warren Parkway, Suite 100, Frisco, TX 75034
www.netwrix.com


--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 7:33 AM
To: techsupport@netwrix.com
Cc: benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref

 

Hello Emiliano

 

I’ve tried to add the custom rule but the result is same.

Sorry but vould you explain me what mean Web UI ?

 

Best regards

Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 

 

 

 


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : mercredi 9 avril 2025 15:19
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello Maltaverne,

Thank you for contacting Netwrix Support. Please note that I will be assisting you with your query regarding custom rules in PingCastle. I will be getting back to you with updates on this. Meanwhile if you have any additional questions and concerns please feel free to add your comments.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation

ref:!00D70091pB.!500Qk0NrOqH:ref","RE: Netwrix Support Ticket #441448 -  - How to use custom rules on standalone pingcastle client    [ ref:!00D70091pB.!500Qk0NrOqH:ref ]","techsupport@netwrix.com","Netwrix Support","julien.maltaverne@thalesgroup.com","kyle.vogley@netwrix.com","shaheryar.ali.tahir@netwrix.com; brandon.west@netwrix.com","true","2025-04-10T10:28:56.000Z","true"
"02sQk00000NaaXcIAJ","500Qk00000NrOqHIAV","2025-04-10T10:38:59.000Z","2025-04-10T12:33:21.000Z","ref:_00D7091pB._500Q000NrOqH:ref

Hello

Thank you for your support.
We only use PingCastle.exe.config
In my case I’m looking for P-DsHeuristicsDoListObject parameters to :

  1.  Increase oradad maturity level to 5
  2.  Otherwise remove this check
Can you help me to find the right custom rule for that ?

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com>
Envoyé : jeudi 10 avril 2025 12:29
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello Julien!

Please refer to the following documentation and let me know if this helps:

Using rule customization in PingCastle Pro and Enterprise

Rule customization is a paid for feature and is easily configurable in the Professional and Enterprise editions. Customers can use this if they disagree with the rules we set and want to change them themselves but also serves as a useful way to understand the rule customizations visually.

To modify custom rules users can follow this process:

 - Login to the Web Application
 - Navigate to Configuration → Custom Rules
 - Click on New Customization
 - Select the Rule ID that needs to be customized
 - Click on  Next
 - Use the Maturity Level dropdown to change the maturity level for a rule.
   - This will affect the “Maturity Assessment” section of the report
 - Rule (Scoring) customization options
   -  Append Rule - This adds a new rule to the current list of rules used for scoring
   -  Load Original Rules - This loads the rules specified by Netwrix and can be used to understand the logic and slightly adjust things.
   -  Clear - Reverts back to the Netwrix specified scoring


Example

In this example the A-KRBTGT rule will be modified so that we get a score of 5 points if its password is over 42 days old and then we double it to 10 points when its password is older than a year but we will leave it in the Level 2 Maturity Assessment
[image]

[image (1)]

Running PingCastle using the custom rules

Here we will go through how to use PingCastle.exe with the custom rules.

Using the API

Running PingCastle.exe using the api options will automatically download the custom rules from the PingCastle Web Application.




`PingCastle.exe --HealthCheck --Server DC.domain.local --api-endpoint https://pc.domain.local --api-key blahblahblah`

This happens via the AgentController and the GetSettings API call.


Using the PingCastle.exe.config

For disconnected networks that cannot contact the PingCastle web application it is possible to use the PingCastle.exe.config to specify custom rules. You still specify them in the Web UI then click on download. You will then be presented with the XML configuration needed and you can copy that into the PingCastle.exe.config.



NOTE: You only really need to copy the <CustomRulesSettings> tag and overwrite any existing one in the PingCastle.exe.config. The <configSections> should already be in the file.


[image (2)]


You can see here how this may end up looking in an actual PingCastle.exe.config.

[image (3)]


Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation






--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/9/2025 9:36 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>; benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #441448 - ref:_00D7091pB._500Q000NrOqH:ref - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref


Another information :

I’ve tried to modify custom rules by using the values defined below :

namespace PingCastle.Healthcheck.Rules
{
[RuleModel(""P-DsHeuristicsDoListObject"", RiskRuleCategory.PrivilegedAccounts, RiskModelCategory.ACLCheck)]
[RuleComputation(RuleComputationType.TriggerOnPresence, 0)]
[RuleIntroducedIn(2, 7)]
[RuleMaturityLevel(2)]
[RuleMitreAttackMitigation(MitreAttackMitigation.ActiveDirectoryConfiguration)]
public class HeatlcheckRulePrivilegedDsHeuristicsDoListObject : RuleBase<HealthcheckData>
{
protected override int? AnalyzeDataNew(HealthcheckData healthcheckData)
{
if (healthcheckData.DSHeuristics != null && healthcheckData.DSHeuristics.Length >= 3 && healthcheckData.DSHeuristics.Substring(2, 1) != ""0"")
{
return 1;
}
return 0;
}
}
}

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : MALTAVERNE Julien
Envoyé : mercredi 9 avril 2025 15:29
À : 'Netwrix Support' <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>; LORACH Benoit <benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>>
Objet : RE: How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello

Thank you for contacting me.
You can find bellow the discussion in the Support Ticket 439303.

Best regards
Julien
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 9:42 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref


Emiliano

I don’t use --api-endpoint.
But I’ve checked my PingCastle version. It’s an auditor version. It seems that “custom rules” are only functional on pro version.

I try add a maturitylevel section but It’s not good….

<customRulesSettings>

    <CustomRules>

      <!--Risk P-DsHeuristicsDoListObject-->

      <CustomRule RiskId=""P-DsHeuristicsDoListObject"">

               <MaturityLevel MaturityLevel=”5”/>

      </CustomRule>

    </CustomRules>

  </customRulesSettings>

Regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : lundi 24 mars 2025 13:32
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : LORACH Benoit <benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>>
Objet : RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

Hi Julien,

The web UI is the web User Interface.

Then, let me ask you something, are you using the --api-endpoint ? If so, it could be overwriting the rule that you are trying to add and that's why is not being modified.
Please let me know that, so I can further investigate to assist you.

Thank you!
Regards,

Emiliano Kraiñuk
Technical Support Engineer
1-949-407-5125
____________________ __________
Cybersecurity That Works for You

Netwrix | 6160 Warren Parkway, Suite 100, Frisco, TX 75034
www.netwrix.com<http://www.netwrix.com>


--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 7:33 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref


Hello Emiliano

I’ve tried to add the custom rule but the result is same.
Sorry but vould you explain me what mean Web UI ?

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>




Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : mercredi 9 avril 2025 15:19
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Objet : How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello Maltaverne,

Thank you for contacting Netwrix Support. Please note that I will be assisting you with your query regarding custom rules in PingCastle. I will be getting back to you with updates on this. Meanwhile if you have any additional questions and concerns please feel free to add your comments.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation

ref:!00D70091pB.!500Qk0NrOqH:ref","RE: Netwrix Support Ticket #441448 -  - How to use custom rules on standalone pingcastle client    [ ref:!00D70091pB.!500Qk0NrOqH:ref ]","julien.maltaverne@thalesgroup.com","MALTAVERNE Julien","techsupport@netwrix.com","kyle.vogley@netwrix.com; benoit.lorach@thalesgroup.com","","true","2025-04-10T10:38:44.000Z","true"
"02sQk00000NdUDtIAN","500Qk00000NrOqHIAV","2025-04-11T11:25:53.000Z","2025-04-11T11:25:53.000Z","Julien - thanks for your response. We are looking into the specifics of P-DsHeuristicsDoListObject parameters for you. I will get back to you with the updates soon. Thanks for your cooperation.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/10/2025 6:38 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com; benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref



Hello

 

Thank you for your support.
We only use PingCastle.exe.config

In my case I’m looking for P-DsHeuristicsDoListObject parameters to :


	Increase oradad maturity level to 5
	Otherwise remove this check


Can you help me to find the right custom rule for that ?

 

Best regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : jeudi 10 avril 2025 12:29
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello Julien!

Please refer to the following documentation and let me know if this helps:

Using rule customization in PingCastle Pro and Enterprise

Rule customization is a paid for feature and is easily configurable in the Professional and Enterprise editions. Customers can use this if they disagree with the rules we set and want to change them themselves but also serves as a useful way to understand the rule customizations visually.

To modify custom rules users can follow this process:

 - Login to the Web Application
 - Navigate to Configuration → Custom Rules 
 - Click on New Customization 
 - Select the Rule ID that needs to be customized
 - Click on  Next 
 - Use the Maturity Level dropdown to change the maturity level for a rule. 
   - This will affect the “Maturity Assessment” section of the report
 - Rule (Scoring) customization options
   -  Append Rule - This adds a new rule to the current list of rules used for scoring
   -  Load Original Rules - This loads the rules specified by Netwrix and can be used to understand the logic and slightly adjust things.
   -  Clear - Reverts back to the Netwrix specified scoring


Example

In this example the A-KRBTGT rule will be modified so that we get a score of 5 points if its password is over 42 days old and then we double it to 10 points when its password is older than a year but we will leave it in the Level 2 Maturity Assessment




Running PingCastle using the custom rules

Here we will go through how to use PingCastle.exe with the custom rules.

Using the API

Running PingCastle.exe using the api options will automatically download the custom rules from the PingCastle Web Application.
 



`PingCastle.exe --HealthCheck --Server DC.domain.local --api-endpoint https://pc.domain.local --api-key blahblahblah`



This happens via the AgentController and the GetSettings API call.


Using the PingCastle.exe.config

For disconnected networks that cannot contact the PingCastle web application it is possible to use the PingCastle.exe.config to specify custom rules. You still specify them in the Web UI then click on download. You will then be presented with the XML configuration needed and you can copy that into the PingCastle.exe.config.



NOTE: You only really need to copy the <CustomRulesSettings> tag and overwrite any existing one in the PingCastle.exe.config. The <configSections> should already be in the file.



 

You can see here how this may end up looking in an actual PingCastle.exe.config.





Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation






--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/9/2025 9:36 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com;  benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #441448 - ref:_00D7091pB._500Q000NrOqH:ref - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref

 


Another information :

 

I’ve tried to modify custom rules by using the values defined below :

namespace PingCastle.Healthcheck.Rules
{
[RuleModel(""P-DsHeuristicsDoListObject"", RiskRuleCategory.PrivilegedAccounts, RiskModelCategory.ACLCheck)]
[RuleComputation(RuleComputationType.TriggerOnPresence, 0)]
[RuleIntroducedIn(2, 7)]
[RuleMaturityLevel(2)]
[RuleMitreAttackMitigation(MitreAttackMitigation.ActiveDirectoryConfiguration)]
public class HeatlcheckRulePrivilegedDsHeuristicsDoListObject : RuleBase<HealthcheckData>
{
protected override int? AnalyzeDataNew(HealthcheckData healthcheckData)
{
if (healthcheckData.DSHeuristics != null && healthcheckData.DSHeuristics.Length >= 3 && healthcheckData.DSHeuristics.Substring(2, 1) != ""0"")
{
return 1;
}
return 0;
}
}
}

 

Best regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : MALTAVERNE Julien
Envoyé : mercredi 9 avril 2025 15:29
À : 'Netwrix Support' <techsupport@netwrix.com>
Cc : kyle.vogley@netwrix.com; LORACH Benoit <benoit.lorach@thalesgroup.com>
Objet : RE: How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello

 

Thank you for contacting me.
You can find bellow the discussion in the Support Ticket 439303.

 

Best regards 

Julien

From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 9:42 AM
To: techsupport@netwrix.com
Cc: benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref

 

Emiliano

 

I don’t use --api-endpoint.

But I’ve checked my PingCastle version. It’s an auditor version. It seems that “custom rules” are only functional on pro version.

 

I try add a maturitylevel section but It’s not good….

 

<customRulesSettings>

 

    <CustomRules>

 

      <!--Risk P-DsHeuristicsDoListObject-->

 

      <CustomRule RiskId=""P-DsHeuristicsDoListObject"">

 

               <MaturityLevel MaturityLevel=”5”/>

 

      </CustomRule>

 

    </CustomRules>

 

  </customRulesSettings>

 

Regards

Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 

 

De : Netwrix Support <techsupport@netwrix.com>
Envoyé : lundi 24 mars 2025 13:32
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : LORACH Benoit <benoit.lorach@thalesgroup.com>
Objet : RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

 

Hi Julien,

The web UI is the web User Interface.

Then, let me ask you something, are you using the --api-endpoint ? If so, it could be overwriting the rule that you are trying to add and that's why is not being modified.
Please let me know that, so I can further investigate to assist you.

Thank you!
Regards,

Emiliano Kraiñuk
Technical Support Engineer
1-949-407-5125
____________________ __________
Cybersecurity That Works for You

Netwrix | 6160 Warren Parkway, Suite 100, Frisco, TX 75034
www.netwrix.com


--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 7:33 AM
To: techsupport@netwrix.com
Cc: benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref

 

Hello Emiliano

 

I’ve tried to add the custom rule but the result is same.

Sorry but vould you explain me what mean Web UI ?

 

Best regards

Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 

 

 

 


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : mercredi 9 avril 2025 15:19
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello Maltaverne,

Thank you for contacting Netwrix Support. Please note that I will be assisting you with your query regarding custom rules in PingCastle. I will be getting back to you with updates on this. Meanwhile if you have any additional questions and concerns please feel free to add your comments.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation

ref:!00D70091pB.!500Qk0NrOqH:ref","RE: Netwrix Support Ticket #441448 -  - How to use custom rules on standalone pingcastle client    [ ref:!00D70091pB.!500Qk0NrOqH:ref ]","techsupport@netwrix.com","Netwrix Support","julien.maltaverne@thalesgroup.com","kyle.vogley@netwrix.com","shaheryar.ali.tahir@netwrix.com","true","2025-04-11T11:25:51.000Z","true"
"02sQk00000NdXDNIA3","500Qk00000NrOqHIAV","2025-04-11T11:53:11.000Z","2025-04-11T13:27:02.000Z","ref:_00D7091pB._500Q000NrOqH:ref

Hello

Thank you so much.

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com>
Envoyé : vendredi 11 avril 2025 13:26
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Julien - thanks for your response. We are looking into the specifics of P-DsHeuristicsDoListObject parameters for you. I will get back to you with the updates soon. Thanks for your cooperation.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/10/2025 6:38 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>; benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref


Hello

Thank you for your support.
We only use PingCastle.exe.config
In my case I’m looking for P-DsHeuristicsDoListObject parameters to :

  1.  Increase oradad maturity level to 5
  2.  Otherwise remove this check
Can you help me to find the right custom rule for that ?

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : jeudi 10 avril 2025 12:29
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello Julien!

Please refer to the following documentation and let me know if this helps:

Using rule customization in PingCastle Pro and Enterprise

Rule customization is a paid for feature and is easily configurable in the Professional and Enterprise editions. Customers can use this if they disagree with the rules we set and want to change them themselves but also serves as a useful way to understand the rule customizations visually.

To modify custom rules users can follow this process:

 - Login to the Web Application
 - Navigate to Configuration → Custom Rules
 - Click on New Customization
 - Select the Rule ID that needs to be customized
 - Click on  Next
 - Use the Maturity Level dropdown to change the maturity level for a rule.
   - This will affect the “Maturity Assessment” section of the report
 - Rule (Scoring) customization options
   -  Append Rule - This adds a new rule to the current list of rules used for scoring
   -  Load Original Rules - This loads the rules specified by Netwrix and can be used to understand the logic and slightly adjust things.
   -  Clear - Reverts back to the Netwrix specified scoring


Example

In this example the A-KRBTGT rule will be modified so that we get a score of 5 points if its password is over 42 days old and then we double it to 10 points when its password is older than a year but we will leave it in the Level 2 Maturity Assessment
[image]

[image (1)]

Running PingCastle using the custom rules

Here we will go through how to use PingCastle.exe with the custom rules.

Using the API

Running PingCastle.exe using the api options will automatically download the custom rules from the PingCastle Web Application.




`PingCastle.exe --HealthCheck --Server DC.domain.local --api-endpoint https://pc.domain.local --api-key blahblahblah`

This happens via the AgentController and the GetSettings API call.


Using the PingCastle.exe.config

For disconnected networks that cannot contact the PingCastle web application it is possible to use the PingCastle.exe.config to specify custom rules. You still specify them in the Web UI then click on download. You will then be presented with the XML configuration needed and you can copy that into the PingCastle.exe.config.



NOTE: You only really need to copy the <CustomRulesSettings> tag and overwrite any existing one in the PingCastle.exe.config. The <configSections> should already be in the file.


[image (2)]


You can see here how this may end up looking in an actual PingCastle.exe.config.

[image (3)]


Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation






--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/9/2025 9:36 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>; benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #441448 - ref:_00D7091pB._500Q000NrOqH:ref - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref


Another information :

I’ve tried to modify custom rules by using the values defined below :

namespace PingCastle.Healthcheck.Rules
{
[RuleModel(""P-DsHeuristicsDoListObject"", RiskRuleCategory.PrivilegedAccounts, RiskModelCategory.ACLCheck)]
[RuleComputation(RuleComputationType.TriggerOnPresence, 0)]
[RuleIntroducedIn(2, 7)]
[RuleMaturityLevel(2)]
[RuleMitreAttackMitigation(MitreAttackMitigation.ActiveDirectoryConfiguration)]
public class HeatlcheckRulePrivilegedDsHeuristicsDoListObject : RuleBase<HealthcheckData>
{
protected override int? AnalyzeDataNew(HealthcheckData healthcheckData)
{
if (healthcheckData.DSHeuristics != null && healthcheckData.DSHeuristics.Length >= 3 && healthcheckData.DSHeuristics.Substring(2, 1) != ""0"")
{
return 1;
}
return 0;
}
}
}

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : MALTAVERNE Julien
Envoyé : mercredi 9 avril 2025 15:29
À : 'Netwrix Support' <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>; LORACH Benoit <benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>>
Objet : RE: How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello

Thank you for contacting me.
You can find bellow the discussion in the Support Ticket 439303.

Best regards
Julien
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 9:42 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref


Emiliano

I don’t use --api-endpoint.
But I’ve checked my PingCastle version. It’s an auditor version. It seems that “custom rules” are only functional on pro version.

I try add a maturitylevel section but It’s not good….

<customRulesSettings>

    <CustomRules>

      <!--Risk P-DsHeuristicsDoListObject-->

      <CustomRule RiskId=""P-DsHeuristicsDoListObject"">

               <MaturityLevel MaturityLevel=”5”/>

      </CustomRule>

    </CustomRules>

  </customRulesSettings>

Regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : lundi 24 mars 2025 13:32
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : LORACH Benoit <benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>>
Objet : RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

Hi Julien,

The web UI is the web User Interface.

Then, let me ask you something, are you using the --api-endpoint ? If so, it could be overwriting the rule that you are trying to add and that's why is not being modified.
Please let me know that, so I can further investigate to assist you.

Thank you!
Regards,

Emiliano Kraiñuk
Technical Support Engineer
1-949-407-5125
____________________ __________
Cybersecurity That Works for You

Netwrix | 6160 Warren Parkway, Suite 100, Frisco, TX 75034
www.netwrix.com<http://www.netwrix.com>


--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 7:33 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref


Hello Emiliano

I’ve tried to add the custom rule but the result is same.
Sorry but vould you explain me what mean Web UI ?

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>




Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : mercredi 9 avril 2025 15:19
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Objet : How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello Maltaverne,

Thank you for contacting Netwrix Support. Please note that I will be assisting you with your query regarding custom rules in PingCastle. I will be getting back to you with updates on this. Meanwhile if you have any additional questions and concerns please feel free to add your comments.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation

ref:!00D70091pB.!500Qk0NrOqH:ref","RE: Netwrix Support Ticket #441448 -  - How to use custom rules on standalone pingcastle client    [ ref:!00D70091pB.!500Qk0NrOqH:ref ]","julien.maltaverne@thalesgroup.com","MALTAVERNE Julien","techsupport@netwrix.com","kyle.vogley@netwrix.com","","true","2025-04-11T11:52:55.000Z","true"
"02sQk00000NiK93IAF","500Qk00000NrOqHIAV","2025-04-14T11:24:43.000Z","2025-04-14T11:24:43.000Z","Hello Julien!

Did you try the following to exclude P-DsHeuristicsDoListObject:

<customRulesSettings>
    <CustomRules>
      <!--Risk P-DsHeuristicsDoListObject-->
      <CustomRule RiskId=""P-DsHeuristicsDoListObject"" />
      </CustomRule>
    </CustomRules>
  </customRulesSettings>

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/11/2025 7:52 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref




Hello

 

Thank you so much.

 

Best regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : vendredi 11 avril 2025 13:26
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Julien - thanks for your response. We are looking into the specifics of P-DsHeuristicsDoListObject parameters for you. I will get back to you with the updates soon. Thanks for your cooperation.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/10/2025 6:38 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com;  benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref

 


Hello

 

Thank you for your support.
We only use PingCastle.exe.config

In my case I’m looking for P-DsHeuristicsDoListObject parameters to :


	Increase oradad maturity level to 5
	Otherwise remove this check


Can you help me to find the right custom rule for that ?

 

Best regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : jeudi 10 avril 2025 12:29
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello Julien!

Please refer to the following documentation and let me know if this helps:

Using rule customization in PingCastle Pro and Enterprise

Rule customization is a paid for feature and is easily configurable in the Professional and Enterprise editions. Customers can use this if they disagree with the rules we set and want to change them themselves but also serves as a useful way to understand the rule customizations visually.

To modify custom rules users can follow this process:

 - Login to the Web Application
 - Navigate to Configuration → Custom Rules 
 - Click on New Customization 
 - Select the Rule ID that needs to be customized
 - Click on  Next 
 - Use the Maturity Level dropdown to change the maturity level for a rule. 
   - This will affect the “Maturity Assessment” section of the report
 - Rule (Scoring) customization options
   -  Append Rule - This adds a new rule to the current list of rules used for scoring
   -  Load Original Rules - This loads the rules specified by Netwrix and can be used to understand the logic and slightly adjust things.
   -  Clear - Reverts back to the Netwrix specified scoring


Example

In this example the A-KRBTGT rule will be modified so that we get a score of 5 points if its password is over 42 days old and then we double it to 10 points when its password is older than a year but we will leave it in the Level 2 Maturity Assessment




Running PingCastle using the custom rules

Here we will go through how to use PingCastle.exe with the custom rules.

Using the API

Running PingCastle.exe using the api options will automatically download the custom rules from the PingCastle Web Application.
 



`PingCastle.exe --HealthCheck --Server DC.domain.local --api-endpoint https://pc.domain.local --api-key blahblahblah`



This happens via the AgentController and the GetSettings API call.


Using the PingCastle.exe.config

For disconnected networks that cannot contact the PingCastle web application it is possible to use the PingCastle.exe.config to specify custom rules. You still specify them in the Web UI then click on download. You will then be presented with the XML configuration needed and you can copy that into the PingCastle.exe.config.



NOTE: You only really need to copy the <CustomRulesSettings> tag and overwrite any existing one in the PingCastle.exe.config. The <configSections> should already be in the file.



 

You can see here how this may end up looking in an actual PingCastle.exe.config.





Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation






--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/9/2025 9:36 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com; benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #441448 - ref:_00D7091pB._500Q000NrOqH:ref - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref

 


Another information :

 

I’ve tried to modify custom rules by using the values defined below :

namespace PingCastle.Healthcheck.Rules
{
[RuleModel(""P-DsHeuristicsDoListObject"", RiskRuleCategory.PrivilegedAccounts, RiskModelCategory.ACLCheck)]
[RuleComputation(RuleComputationType.TriggerOnPresence, 0)]
[RuleIntroducedIn(2, 7)]
[RuleMaturityLevel(2)]
[RuleMitreAttackMitigation(MitreAttackMitigation.ActiveDirectoryConfiguration)]
public class HeatlcheckRulePrivilegedDsHeuristicsDoListObject : RuleBase<HealthcheckData>
{
protected override int? AnalyzeDataNew(HealthcheckData healthcheckData)
{
if (healthcheckData.DSHeuristics != null && healthcheckData.DSHeuristics.Length >= 3 && healthcheckData.DSHeuristics.Substring(2, 1) != ""0"")
{
return 1;
}
return 0;
}
}
}

 

Best regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : MALTAVERNE Julien
Envoyé : mercredi 9 avril 2025 15:29
À : 'Netwrix Support' <techsupport@netwrix.com>
Cc : kyle.vogley@netwrix.com; LORACH Benoit <benoit.lorach@thalesgroup.com>
Objet : RE: How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello

 

Thank you for contacting me.
You can find bellow the discussion in the Support Ticket 439303.

 

Best regards 

Julien

From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 9:42 AM
To: techsupport@netwrix.com
Cc: benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref

 

Emiliano

 

I don’t use --api-endpoint.

But I’ve checked my PingCastle version. It’s an auditor version. It seems that “custom rules” are only functional on pro version.

 

I try add a maturitylevel section but It’s not good….

 

<customRulesSettings>

 

    <CustomRules>

 

      <!--Risk P-DsHeuristicsDoListObject-->

 

      <CustomRule RiskId=""P-DsHeuristicsDoListObject"">

 

               <MaturityLevel MaturityLevel=”5”/>

 

      </CustomRule>

 

    </CustomRules>

 

  </customRulesSettings>

 

Regards

Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 

 

De : Netwrix Support <techsupport@netwrix.com>
Envoyé : lundi 24 mars 2025 13:32
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : LORACH Benoit <benoit.lorach@thalesgroup.com>
Objet : RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

 

Hi Julien,

The web UI is the web User Interface.

Then, let me ask you something, are you using the --api-endpoint ? If so, it could be overwriting the rule that you are trying to add and that's why is not being modified.
Please let me know that, so I can further investigate to assist you.

Thank you!
Regards,

Emiliano Kraiñuk
Technical Support Engineer
1-949-407-5125
____________________ __________
Cybersecurity That Works for You

Netwrix | 6160 Warren Parkway, Suite 100, Frisco, TX 75034
www.netwrix.com


--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 7:33 AM
To: techsupport@netwrix.com
Cc: benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref

 

Hello Emiliano

 

I’ve tried to add the custom rule but the result is same.

Sorry but vould you explain me what mean Web UI ?

 

Best regards

Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 

 

 

 


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : mercredi 9 avril 2025 15:19
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello Maltaverne,

Thank you for contacting Netwrix Support. Please note that I will be assisting you with your query regarding custom rules in PingCastle. I will be getting back to you with updates on this. Meanwhile if you have any additional questions and concerns please feel free to add your comments.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation

ref:!00D70091pB.!500Qk0NrOqH:ref","RE: Netwrix Support Ticket #441448 -  - How to use custom rules on standalone pingcastle client    [ ref:!00D70091pB.!500Qk0NrOqH:ref ]","techsupport@netwrix.com","Netwrix Support","julien.maltaverne@thalesgroup.com","kyle.vogley@netwrix.com","shaheryar.ali.tahir@netwrix.com","true","2025-04-14T11:24:43.000Z","true"
"02sQk00000NiGdLIAV","500Qk00000NrOqHIAV","2025-04-14T11:25:05.000Z","2025-04-14T11:43:36.000Z","ref:_00D7091pB._500Q000NrOqH:ref

Bonjour

Je suis absent du bureau du lundi 14 avril au vendredi 18 avril.
Pour tout problème merci d'adresser un mail à fr-tgs-dsv-support@thalesgroup.com ou
FR-TGS-TrustedCore@thalesgroup.com

Cordialement
Julien MALTAVERNE
Technical Directory Architect
TGS / DSI France
Mobile : 06 74 08 24 36","Réponse automatique : Netwrix Support Ticket #441448 -  - How to use custom rules on standalone pingcastle client    [ ref:!00D70091pB.!500Qk0NrOqH:ref ]","julien.maltaverne@thalesgroup.com","MALTAVERNE Julien","techsupport@netwrix.com","","","false","2025-04-14T11:24:51.000Z","true"
"02sQk00000O08uEIAR","500Qk00000NrOqHIAV","2025-04-22T07:34:38.000Z","2025-04-22T07:48:58.000Z","ref:_00D7091pB._500Q000NrOqH:ref

Hello

Thank so you so much.
I’ll try this parameter.

Regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com>
Envoyé : lundi 14 avril 2025 13:25
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]


Hello Julien!

Did you try the following to exclude P-DsHeuristicsDoListObject:

<customRulesSettings>
    <CustomRules>
      <!--Risk P-DsHeuristicsDoListObject-->
      <CustomRule RiskId=""P-DsHeuristicsDoListObject"" />
      </CustomRule>
    </CustomRules>
  </customRulesSettings>

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/11/2025 7:52 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref


Hello

Thank you so much.

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : vendredi 11 avril 2025 13:26
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Julien - thanks for your response. We are looking into the specifics of P-DsHeuristicsDoListObject parameters for you. I will get back to you with the updates soon. Thanks for your cooperation.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/10/2025 6:38 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>; benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref


Hello

Thank you for your support.
We only use PingCastle.exe.config
In my case I’m looking for P-DsHeuristicsDoListObject parameters to :

  1.  Increase oradad maturity level to 5
  2.  Otherwise remove this check
Can you help me to find the right custom rule for that ?

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : jeudi 10 avril 2025 12:29
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello Julien!

Please refer to the following documentation and let me know if this helps:

Using rule customization in PingCastle Pro and Enterprise

Rule customization is a paid for feature and is easily configurable in the Professional and Enterprise editions. Customers can use this if they disagree with the rules we set and want to change them themselves but also serves as a useful way to understand the rule customizations visually.

To modify custom rules users can follow this process:

 - Login to the Web Application
 - Navigate to Configuration → Custom Rules
 - Click on New Customization
 - Select the Rule ID that needs to be customized
 - Click on  Next
 - Use the Maturity Level dropdown to change the maturity level for a rule.
   - This will affect the “Maturity Assessment” section of the report
 - Rule (Scoring) customization options
   -  Append Rule - This adds a new rule to the current list of rules used for scoring
   -  Load Original Rules - This loads the rules specified by Netwrix and can be used to understand the logic and slightly adjust things.
   -  Clear - Reverts back to the Netwrix specified scoring


Example

In this example the A-KRBTGT rule will be modified so that we get a score of 5 points if its password is over 42 days old and then we double it to 10 points when its password is older than a year but we will leave it in the Level 2 Maturity Assessment
[image]

[image (1)]

Running PingCastle using the custom rules

Here we will go through how to use PingCastle.exe with the custom rules.

Using the API

Running PingCastle.exe using the api options will automatically download the custom rules from the PingCastle Web Application.




`PingCastle.exe --HealthCheck --Server DC.domain.local --api-endpoint https://pc.domain.local --api-key blahblahblah`

This happens via the AgentController and the GetSettings API call.


Using the PingCastle.exe.config

For disconnected networks that cannot contact the PingCastle web application it is possible to use the PingCastle.exe.config to specify custom rules. You still specify them in the Web UI then click on download. You will then be presented with the XML configuration needed and you can copy that into the PingCastle.exe.config.



NOTE: You only really need to copy the <CustomRulesSettings> tag and overwrite any existing one in the PingCastle.exe.config. The <configSections> should already be in the file.


[image (2)]


You can see here how this may end up looking in an actual PingCastle.exe.config.

[image (3)]


Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation






--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/9/2025 9:36 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>; benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #441448 - ref:_00D7091pB._500Q000NrOqH:ref - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref


Another information :

I’ve tried to modify custom rules by using the values defined below :

namespace PingCastle.Healthcheck.Rules
{
[RuleModel(""P-DsHeuristicsDoListObject"", RiskRuleCategory.PrivilegedAccounts, RiskModelCategory.ACLCheck)]
[RuleComputation(RuleComputationType.TriggerOnPresence, 0)]
[RuleIntroducedIn(2, 7)]
[RuleMaturityLevel(2)]
[RuleMitreAttackMitigation(MitreAttackMitigation.ActiveDirectoryConfiguration)]
public class HeatlcheckRulePrivilegedDsHeuristicsDoListObject : RuleBase<HealthcheckData>
{
protected override int? AnalyzeDataNew(HealthcheckData healthcheckData)
{
if (healthcheckData.DSHeuristics != null && healthcheckData.DSHeuristics.Length >= 3 && healthcheckData.DSHeuristics.Substring(2, 1) != ""0"")
{
return 1;
}
return 0;
}
}
}

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : MALTAVERNE Julien
Envoyé : mercredi 9 avril 2025 15:29
À : 'Netwrix Support' <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>; LORACH Benoit <benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>>
Objet : RE: How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello

Thank you for contacting me.
You can find bellow the discussion in the Support Ticket 439303.

Best regards
Julien
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 9:42 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref


Emiliano

I don’t use --api-endpoint.
But I’ve checked my PingCastle version. It’s an auditor version. It seems that “custom rules” are only functional on pro version.

I try add a maturitylevel section but It’s not good….

<customRulesSettings>

    <CustomRules>

      <!--Risk P-DsHeuristicsDoListObject-->

      <CustomRule RiskId=""P-DsHeuristicsDoListObject"">

               <MaturityLevel MaturityLevel=”5”/>

      </CustomRule>

    </CustomRules>

  </customRulesSettings>

Regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : lundi 24 mars 2025 13:32
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : LORACH Benoit <benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>>
Objet : RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

Hi Julien,

The web UI is the web User Interface.

Then, let me ask you something, are you using the --api-endpoint ? If so, it could be overwriting the rule that you are trying to add and that's why is not being modified.
Please let me know that, so I can further investigate to assist you.

Thank you!
Regards,

Emiliano Kraiñuk
Technical Support Engineer
1-949-407-5125
____________________ __________
Cybersecurity That Works for You

Netwrix | 6160 Warren Parkway, Suite 100, Frisco, TX 75034
www.netwrix.com<http://www.netwrix.com>


--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 7:33 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref


Hello Emiliano

I’ve tried to add the custom rule but the result is same.
Sorry but vould you explain me what mean Web UI ?

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>




Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : mercredi 9 avril 2025 15:19
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Objet : How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello Maltaverne,

Thank you for contacting Netwrix Support. Please note that I will be assisting you with your query regarding custom rules in PingCastle. I will be getting back to you with updates on this. Meanwhile if you have any additional questions and concerns please feel free to add your comments.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation

ref:!00D70091pB.!500Qk0NrOqH:ref","RE: Netwrix Support Ticket #441448 -  - How to use custom rules on standalone pingcastle client    [ ref:!00D70091pB.!500Qk0NrOqH:ref ]","julien.maltaverne@thalesgroup.com","MALTAVERNE Julien","techsupport@netwrix.com","kyle.vogley@netwrix.com","","true","2025-04-22T07:33:16.000Z","true"
"02sQk00000O32fOIAR","500Qk00000NrOqHIAV","2025-04-23T09:38:31.000Z","2025-04-23T09:38:31.000Z","Hello Julien!

Hope you are doing alright. I just wanted to check with you if there is anything else that you need help with or should I go ahead and close this ticket?

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/22/2025 3:33 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref




Hello

 

Thank so you so much.
I’ll try this parameter.

 

Regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : lundi 14 avril 2025 13:25
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello Julien!

Did you try the following to exclude P-DsHeuristicsDoListObject:

<customRulesSettings>
    <CustomRules>
      <!--Risk P-DsHeuristicsDoListObject-->
      <CustomRule RiskId=""P-DsHeuristicsDoListObject"" />
      </CustomRule>
    </CustomRules>
  </customRulesSettings>

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/11/2025 7:52 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref

 


Hello

 

Thank you so much.

 

Best regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : vendredi 11 avril 2025 13:26
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Julien - thanks for your response. We are looking into the specifics of P-DsHeuristicsDoListObject parameters for you. I will get back to you with the updates soon. Thanks for your cooperation.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/10/2025 6:38 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com; benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref

 


Hello

 

Thank you for your support.
We only use PingCastle.exe.config

In my case I’m looking for P-DsHeuristicsDoListObject parameters to :


	Increase oradad maturity level to 5
	Otherwise remove this check


Can you help me to find the right custom rule for that ?

 

Best regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : jeudi 10 avril 2025 12:29
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello Julien!

Please refer to the following documentation and let me know if this helps:

Using rule customization in PingCastle Pro and Enterprise

Rule customization is a paid for feature and is easily configurable in the Professional and Enterprise editions. Customers can use this if they disagree with the rules we set and want to change them themselves but also serves as a useful way to understand the rule customizations visually.

To modify custom rules users can follow this process:

 - Login to the Web Application
 - Navigate to Configuration → Custom Rules 
 - Click on New Customization 
 - Select the Rule ID that needs to be customized
 - Click on  Next 
 - Use the Maturity Level dropdown to change the maturity level for a rule. 
   - This will affect the “Maturity Assessment” section of the report
 - Rule (Scoring) customization options
   -  Append Rule - This adds a new rule to the current list of rules used for scoring
   -  Load Original Rules - This loads the rules specified by Netwrix and can be used to understand the logic and slightly adjust things.
   -  Clear - Reverts back to the Netwrix specified scoring


Example

In this example the A-KRBTGT rule will be modified so that we get a score of 5 points if its password is over 42 days old and then we double it to 10 points when its password is older than a year but we will leave it in the Level 2 Maturity Assessment




Running PingCastle using the custom rules

Here we will go through how to use PingCastle.exe with the custom rules.

Using the API

Running PingCastle.exe using the api options will automatically download the custom rules from the PingCastle Web Application.
 



`PingCastle.exe --HealthCheck --Server DC.domain.local --api-endpoint https://pc.domain.local --api-key blahblahblah`



This happens via the AgentController and the GetSettings API call.


Using the PingCastle.exe.config

For disconnected networks that cannot contact the PingCastle web application it is possible to use the PingCastle.exe.config to specify custom rules. You still specify them in the Web UI then click on download. You will then be presented with the XML configuration needed and you can copy that into the PingCastle.exe.config.



NOTE: You only really need to copy the <CustomRulesSettings> tag and overwrite any existing one in the PingCastle.exe.config. The <configSections> should already be in the file.



 

You can see here how this may end up looking in an actual PingCastle.exe.config.





Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation






--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/9/2025 9:36 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com; benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #441448 - ref:_00D7091pB._500Q000NrOqH:ref - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref

 


Another information :

 

I’ve tried to modify custom rules by using the values defined below :

namespace PingCastle.Healthcheck.Rules
{
[RuleModel(""P-DsHeuristicsDoListObject"", RiskRuleCategory.PrivilegedAccounts, RiskModelCategory.ACLCheck)]
[RuleComputation(RuleComputationType.TriggerOnPresence, 0)]
[RuleIntroducedIn(2, 7)]
[RuleMaturityLevel(2)]
[RuleMitreAttackMitigation(MitreAttackMitigation.ActiveDirectoryConfiguration)]
public class HeatlcheckRulePrivilegedDsHeuristicsDoListObject : RuleBase<HealthcheckData>
{
protected override int? AnalyzeDataNew(HealthcheckData healthcheckData)
{
if (healthcheckData.DSHeuristics != null && healthcheckData.DSHeuristics.Length >= 3 && healthcheckData.DSHeuristics.Substring(2, 1) != ""0"")
{
return 1;
}
return 0;
}
}
}

 

Best regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : MALTAVERNE Julien
Envoyé : mercredi 9 avril 2025 15:29
À : 'Netwrix Support' <techsupport@netwrix.com>
Cc : kyle.vogley@netwrix.com; LORACH Benoit <benoit.lorach@thalesgroup.com>
Objet : RE: How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello

 

Thank you for contacting me.
You can find bellow the discussion in the Support Ticket 439303.

 

Best regards 

Julien

From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 9:42 AM
To: techsupport@netwrix.com
Cc: benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref

 

Emiliano

 

I don’t use --api-endpoint.

But I’ve checked my PingCastle version. It’s an auditor version. It seems that “custom rules” are only functional on pro version.

 

I try add a maturitylevel section but It’s not good….

 

<customRulesSettings>

 

    <CustomRules>

 

      <!--Risk P-DsHeuristicsDoListObject-->

 

      <CustomRule RiskId=""P-DsHeuristicsDoListObject"">

 

               <MaturityLevel MaturityLevel=”5”/>

 

      </CustomRule>

 

    </CustomRules>

 

  </customRulesSettings>

 

Regards

Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 

 

De : Netwrix Support <techsupport@netwrix.com>
Envoyé : lundi 24 mars 2025 13:32
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : LORACH Benoit <benoit.lorach@thalesgroup.com>
Objet : RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

 

Hi Julien,

The web UI is the web User Interface.

Then, let me ask you something, are you using the --api-endpoint ? If so, it could be overwriting the rule that you are trying to add and that's why is not being modified.
Please let me know that, so I can further investigate to assist you.

Thank you!
Regards,

Emiliano Kraiñuk
Technical Support Engineer
1-949-407-5125
____________________ __________
Cybersecurity That Works for You

Netwrix | 6160 Warren Parkway, Suite 100, Frisco, TX 75034
www.netwrix.com


--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 7:33 AM
To: techsupport@netwrix.com
Cc: benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref

 

Hello Emiliano

 

I’ve tried to add the custom rule but the result is same.

Sorry but vould you explain me what mean Web UI ?

 

Best regards

Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 

 

 

 


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : mercredi 9 avril 2025 15:19
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello Maltaverne,

Thank you for contacting Netwrix Support. Please note that I will be assisting you with your query regarding custom rules in PingCastle. I will be getting back to you with updates on this. Meanwhile if you have any additional questions and concerns please feel free to add your comments.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation

ref:!00D70091pB.!500Qk0NrOqH:ref","RE: Netwrix Support Ticket #441448 -  - How to use custom rules on standalone pingcastle client    [ ref:!00D70091pB.!500Qk0NrOqH:ref ]","techsupport@netwrix.com","Netwrix Support","julien.maltaverne@thalesgroup.com","kyle.vogley@netwrix.com","shaheryar.ali.tahir@netwrix.com","true","2025-04-23T09:38:29.000Z","true"
"02sQk00000O33TQIAZ","500Qk00000NrOqHIAV","2025-04-23T10:09:13.000Z","2025-04-23T11:49:39.000Z","ref:_00D7091pB._500Q000NrOqH:ref

Hello

I can’t test for the moment because my enterprise trial license is expired.
I’ve sent a mail to Wahiba to get another one.

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com>
Envoyé : mercredi 23 avril 2025 11:39
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]


Hello Julien!

Hope you are doing alright. I just wanted to check with you if there is anything else that you need help with or should I go ahead and close this ticket?

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/22/2025 3:33 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref


Hello

Thank so you so much.
I’ll try this parameter.

Regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : lundi 14 avril 2025 13:25
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]


Hello Julien!

Did you try the following to exclude P-DsHeuristicsDoListObject:

<customRulesSettings>
    <CustomRules>
      <!--Risk P-DsHeuristicsDoListObject-->
      <CustomRule RiskId=""P-DsHeuristicsDoListObject"" />
      </CustomRule>
    </CustomRules>
  </customRulesSettings>

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/11/2025 7:52 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref


Hello

Thank you so much.

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : vendredi 11 avril 2025 13:26
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Julien - thanks for your response. We are looking into the specifics of P-DsHeuristicsDoListObject parameters for you. I will get back to you with the updates soon. Thanks for your cooperation.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/10/2025 6:38 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>; benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref


Hello

Thank you for your support.
We only use PingCastle.exe.config
In my case I’m looking for P-DsHeuristicsDoListObject parameters to :

  1.  Increase oradad maturity level to 5
  2.  Otherwise remove this check
Can you help me to find the right custom rule for that ?

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : jeudi 10 avril 2025 12:29
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello Julien!

Please refer to the following documentation and let me know if this helps:

Using rule customization in PingCastle Pro and Enterprise

Rule customization is a paid for feature and is easily configurable in the Professional and Enterprise editions. Customers can use this if they disagree with the rules we set and want to change them themselves but also serves as a useful way to understand the rule customizations visually.

To modify custom rules users can follow this process:

 - Login to the Web Application
 - Navigate to Configuration → Custom Rules
 - Click on New Customization
 - Select the Rule ID that needs to be customized
 - Click on  Next
 - Use the Maturity Level dropdown to change the maturity level for a rule.
   - This will affect the “Maturity Assessment” section of the report
 - Rule (Scoring) customization options
   -  Append Rule - This adds a new rule to the current list of rules used for scoring
   -  Load Original Rules - This loads the rules specified by Netwrix and can be used to understand the logic and slightly adjust things.
   -  Clear - Reverts back to the Netwrix specified scoring


Example

In this example the A-KRBTGT rule will be modified so that we get a score of 5 points if its password is over 42 days old and then we double it to 10 points when its password is older than a year but we will leave it in the Level 2 Maturity Assessment
[image]

[image (1)]

Running PingCastle using the custom rules

Here we will go through how to use PingCastle.exe with the custom rules.

Using the API

Running PingCastle.exe using the api options will automatically download the custom rules from the PingCastle Web Application.




`PingCastle.exe --HealthCheck --Server DC.domain.local --api-endpoint https://pc.domain.local --api-key blahblahblah`

This happens via the AgentController and the GetSettings API call.


Using the PingCastle.exe.config

For disconnected networks that cannot contact the PingCastle web application it is possible to use the PingCastle.exe.config to specify custom rules. You still specify them in the Web UI then click on download. You will then be presented with the XML configuration needed and you can copy that into the PingCastle.exe.config.



NOTE: You only really need to copy the <CustomRulesSettings> tag and overwrite any existing one in the PingCastle.exe.config. The <configSections> should already be in the file.


[image (2)]


You can see here how this may end up looking in an actual PingCastle.exe.config.

[image (3)]


Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation






--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/9/2025 9:36 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>; benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #441448 - ref:_00D7091pB._500Q000NrOqH:ref - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref


Another information :

I’ve tried to modify custom rules by using the values defined below :

namespace PingCastle.Healthcheck.Rules
{
[RuleModel(""P-DsHeuristicsDoListObject"", RiskRuleCategory.PrivilegedAccounts, RiskModelCategory.ACLCheck)]
[RuleComputation(RuleComputationType.TriggerOnPresence, 0)]
[RuleIntroducedIn(2, 7)]
[RuleMaturityLevel(2)]
[RuleMitreAttackMitigation(MitreAttackMitigation.ActiveDirectoryConfiguration)]
public class HeatlcheckRulePrivilegedDsHeuristicsDoListObject : RuleBase<HealthcheckData>
{
protected override int? AnalyzeDataNew(HealthcheckData healthcheckData)
{
if (healthcheckData.DSHeuristics != null && healthcheckData.DSHeuristics.Length >= 3 && healthcheckData.DSHeuristics.Substring(2, 1) != ""0"")
{
return 1;
}
return 0;
}
}
}

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : MALTAVERNE Julien
Envoyé : mercredi 9 avril 2025 15:29
À : 'Netwrix Support' <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>; LORACH Benoit <benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>>
Objet : RE: How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello

Thank you for contacting me.
You can find bellow the discussion in the Support Ticket 439303.

Best regards
Julien
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 9:42 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref


Emiliano

I don’t use --api-endpoint.
But I’ve checked my PingCastle version. It’s an auditor version. It seems that “custom rules” are only functional on pro version.

I try add a maturitylevel section but It’s not good….

<customRulesSettings>

    <CustomRules>

      <!--Risk P-DsHeuristicsDoListObject-->

      <CustomRule RiskId=""P-DsHeuristicsDoListObject"">

               <MaturityLevel MaturityLevel=”5”/>

      </CustomRule>

    </CustomRules>

  </customRulesSettings>

Regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : lundi 24 mars 2025 13:32
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : LORACH Benoit <benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>>
Objet : RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

Hi Julien,

The web UI is the web User Interface.

Then, let me ask you something, are you using the --api-endpoint ? If so, it could be overwriting the rule that you are trying to add and that's why is not being modified.
Please let me know that, so I can further investigate to assist you.

Thank you!
Regards,

Emiliano Kraiñuk
Technical Support Engineer
1-949-407-5125
____________________ __________
Cybersecurity That Works for You

Netwrix | 6160 Warren Parkway, Suite 100, Frisco, TX 75034
www.netwrix.com<http://www.netwrix.com>


--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 7:33 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref


Hello Emiliano

I’ve tried to add the custom rule but the result is same.
Sorry but vould you explain me what mean Web UI ?

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>




Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : mercredi 9 avril 2025 15:19
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Objet : How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello Maltaverne,

Thank you for contacting Netwrix Support. Please note that I will be assisting you with your query regarding custom rules in PingCastle. I will be getting back to you with updates on this. Meanwhile if you have any additional questions and concerns please feel free to add your comments.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation

ref:!00D70091pB.!500Qk0NrOqH:ref","RE: Netwrix Support Ticket #441448 -  - How to use custom rules on standalone pingcastle client    [ ref:!00D70091pB.!500Qk0NrOqH:ref ]","julien.maltaverne@thalesgroup.com","MALTAVERNE Julien","techsupport@netwrix.com","kyle.vogley@netwrix.com","","true","2025-04-23T10:08:58.000Z","true"
"02sQk00000O996NIAR","500Qk00000NrOqHIAV","2025-04-25T15:27:52.000Z","2025-04-25T15:27:52.000Z","Hello Julien!

I hope you are doing well. I just wanted to check if you were able to get your license sorted and tried the proposed solution?

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation


--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/23/2025 6:08 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref



Hello

 

I can’t test for the moment because my enterprise trial license is expired.
I’ve sent a mail to Wahiba to get another one.

 

Best regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : mercredi 23 avril 2025 11:39
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello Julien!

Hope you are doing alright. I just wanted to check with you if there is anything else that you need help with or should I go ahead and close this ticket?

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/22/2025 3:33 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref

 


Hello

 

Thank so you so much.
I’ll try this parameter.

 

Regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : lundi 14 avril 2025 13:25
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello Julien!

Did you try the following to exclude P-DsHeuristicsDoListObject:

<customRulesSettings>
    <CustomRules>
      <!--Risk P-DsHeuristicsDoListObject-->
      <CustomRule RiskId=""P-DsHeuristicsDoListObject"" />
      </CustomRule>
    </CustomRules>
  </customRulesSettings>

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/11/2025 7:52 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref

 


Hello

 

Thank you so much.

 

Best regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : vendredi 11 avril 2025 13:26
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Julien - thanks for your response. We are looking into the specifics of P-DsHeuristicsDoListObject parameters for you. I will get back to you with the updates soon. Thanks for your cooperation.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/10/2025 6:38 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com; benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref

 


Hello

 

Thank you for your support.
We only use PingCastle.exe.config

In my case I’m looking for P-DsHeuristicsDoListObject parameters to :


	Increase oradad maturity level to 5
	Otherwise remove this check


Can you help me to find the right custom rule for that ?

 

Best regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : jeudi 10 avril 2025 12:29
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello Julien!

Please refer to the following documentation and let me know if this helps:

Using rule customization in PingCastle Pro and Enterprise

Rule customization is a paid for feature and is easily configurable in the Professional and Enterprise editions. Customers can use this if they disagree with the rules we set and want to change them themselves but also serves as a useful way to understand the rule customizations visually.

To modify custom rules users can follow this process:

 - Login to the Web Application
 - Navigate to Configuration → Custom Rules 
 - Click on New Customization 
 - Select the Rule ID that needs to be customized
 - Click on  Next 
 - Use the Maturity Level dropdown to change the maturity level for a rule. 
   - This will affect the “Maturity Assessment” section of the report
 - Rule (Scoring) customization options
   -  Append Rule - This adds a new rule to the current list of rules used for scoring
   -  Load Original Rules - This loads the rules specified by Netwrix and can be used to understand the logic and slightly adjust things.
   -  Clear - Reverts back to the Netwrix specified scoring


Example

In this example the A-KRBTGT rule will be modified so that we get a score of 5 points if its password is over 42 days old and then we double it to 10 points when its password is older than a year but we will leave it in the Level 2 Maturity Assessment




Running PingCastle using the custom rules

Here we will go through how to use PingCastle.exe with the custom rules.

Using the API

Running PingCastle.exe using the api options will automatically download the custom rules from the PingCastle Web Application.
 



`PingCastle.exe --HealthCheck --Server DC.domain.local --api-endpoint https://pc.domain.local --api-key blahblahblah`



This happens via the AgentController and the GetSettings API call.


Using the PingCastle.exe.config

For disconnected networks that cannot contact the PingCastle web application it is possible to use the PingCastle.exe.config to specify custom rules. You still specify them in the Web UI then click on download. You will then be presented with the XML configuration needed and you can copy that into the PingCastle.exe.config.



NOTE: You only really need to copy the <CustomRulesSettings> tag and overwrite any existing one in the PingCastle.exe.config. The <configSections> should already be in the file.



 

You can see here how this may end up looking in an actual PingCastle.exe.config.





Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation






--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/9/2025 9:36 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com; benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #441448 - ref:_00D7091pB._500Q000NrOqH:ref - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref

 


Another information :

 

I’ve tried to modify custom rules by using the values defined below :

namespace PingCastle.Healthcheck.Rules
{
[RuleModel(""P-DsHeuristicsDoListObject"", RiskRuleCategory.PrivilegedAccounts, RiskModelCategory.ACLCheck)]
[RuleComputation(RuleComputationType.TriggerOnPresence, 0)]
[RuleIntroducedIn(2, 7)]
[RuleMaturityLevel(2)]
[RuleMitreAttackMitigation(MitreAttackMitigation.ActiveDirectoryConfiguration)]
public class HeatlcheckRulePrivilegedDsHeuristicsDoListObject : RuleBase<HealthcheckData>
{
protected override int? AnalyzeDataNew(HealthcheckData healthcheckData)
{
if (healthcheckData.DSHeuristics != null && healthcheckData.DSHeuristics.Length >= 3 && healthcheckData.DSHeuristics.Substring(2, 1) != ""0"")
{
return 1;
}
return 0;
}
}
}

 

Best regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : MALTAVERNE Julien
Envoyé : mercredi 9 avril 2025 15:29
À : 'Netwrix Support' <techsupport@netwrix.com>
Cc : kyle.vogley@netwrix.com; LORACH Benoit <benoit.lorach@thalesgroup.com>
Objet : RE: How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello

 

Thank you for contacting me.
You can find bellow the discussion in the Support Ticket 439303.

 

Best regards 

Julien

From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 9:42 AM
To: techsupport@netwrix.com
Cc: benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref

 

Emiliano

 

I don’t use --api-endpoint.

But I’ve checked my PingCastle version. It’s an auditor version. It seems that “custom rules” are only functional on pro version.

 

I try add a maturitylevel section but It’s not good….

 

<customRulesSettings>

 

    <CustomRules>

 

      <!--Risk P-DsHeuristicsDoListObject-->

 

      <CustomRule RiskId=""P-DsHeuristicsDoListObject"">

 

               <MaturityLevel MaturityLevel=”5”/>

 

      </CustomRule>

 

    </CustomRules>

 

  </customRulesSettings>

 

Regards

Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 

 

De : Netwrix Support <techsupport@netwrix.com>
Envoyé : lundi 24 mars 2025 13:32
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : LORACH Benoit <benoit.lorach@thalesgroup.com>
Objet : RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

 

Hi Julien,

The web UI is the web User Interface.

Then, let me ask you something, are you using the --api-endpoint ? If so, it could be overwriting the rule that you are trying to add and that's why is not being modified.
Please let me know that, so I can further investigate to assist you.

Thank you!
Regards,

Emiliano Kraiñuk
Technical Support Engineer
1-949-407-5125
____________________ __________
Cybersecurity That Works for You

Netwrix | 6160 Warren Parkway, Suite 100, Frisco, TX 75034
www.netwrix.com


--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 7:33 AM
To: techsupport@netwrix.com
Cc: benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref

 

Hello Emiliano

 

I’ve tried to add the custom rule but the result is same.

Sorry but vould you explain me what mean Web UI ?

 

Best regards

Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 

 

 

 


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : mercredi 9 avril 2025 15:19
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello Maltaverne,

Thank you for contacting Netwrix Support. Please note that I will be assisting you with your query regarding custom rules in PingCastle. I will be getting back to you with updates on this. Meanwhile if you have any additional questions and concerns please feel free to add your comments.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation

ref:!00D70091pB.!500Qk0NrOqH:ref","RE: Netwrix Support Ticket #441448 -  - How to use custom rules on standalone pingcastle client    [ ref:!00D70091pB.!500Qk0NrOqH:ref ]","techsupport@netwrix.com","Netwrix Support","julien.maltaverne@thalesgroup.com","kyle.vogley@netwrix.com","shaheryar.ali.tahir@netwrix.com","true","2025-04-25T15:27:50.000Z","true"
"02sQk00000ODOczIAH","500Qk00000NrOqHIAV","2025-04-28T06:30:31.000Z","2025-04-28T08:42:55.000Z","ref:_00D7091pB._500Q000NrOqH:ref

Hello

Wahiba sent me a trial license so I’ve tried your solution.
That’s good for me. Is it possible to implement “custom rules” on auditor version in the future ?

Thank you
Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com>
Envoyé : vendredi 25 avril 2025 17:28
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello Julien!

I hope you are doing well. I just wanted to check if you were able to get your license sorted and tried the proposed solution?

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation


--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/23/2025 6:08 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref


Hello

I can’t test for the moment because my enterprise trial license is expired.
I’ve sent a mail to Wahiba to get another one.

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : mercredi 23 avril 2025 11:39
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]


Hello Julien!

Hope you are doing alright. I just wanted to check with you if there is anything else that you need help with or should I go ahead and close this ticket?

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/22/2025 3:33 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref


Hello

Thank so you so much.
I’ll try this parameter.

Regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : lundi 14 avril 2025 13:25
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]


Hello Julien!

Did you try the following to exclude P-DsHeuristicsDoListObject:

<customRulesSettings>
    <CustomRules>
      <!--Risk P-DsHeuristicsDoListObject-->
      <CustomRule RiskId=""P-DsHeuristicsDoListObject"" />
      </CustomRule>
    </CustomRules>
  </customRulesSettings>

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/11/2025 7:52 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref


Hello

Thank you so much.

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : vendredi 11 avril 2025 13:26
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Julien - thanks for your response. We are looking into the specifics of P-DsHeuristicsDoListObject parameters for you. I will get back to you with the updates soon. Thanks for your cooperation.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/10/2025 6:38 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>; benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref


Hello

Thank you for your support.
We only use PingCastle.exe.config
In my case I’m looking for P-DsHeuristicsDoListObject parameters to :

  1.  Increase oradad maturity level to 5
  2.  Otherwise remove this check
Can you help me to find the right custom rule for that ?

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : jeudi 10 avril 2025 12:29
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello Julien!

Please refer to the following documentation and let me know if this helps:

Using rule customization in PingCastle Pro and Enterprise

Rule customization is a paid for feature and is easily configurable in the Professional and Enterprise editions. Customers can use this if they disagree with the rules we set and want to change them themselves but also serves as a useful way to understand the rule customizations visually.

To modify custom rules users can follow this process:

 - Login to the Web Application
 - Navigate to Configuration → Custom Rules
 - Click on New Customization
 - Select the Rule ID that needs to be customized
 - Click on  Next
 - Use the Maturity Level dropdown to change the maturity level for a rule.
   - This will affect the “Maturity Assessment” section of the report
 - Rule (Scoring) customization options
   -  Append Rule - This adds a new rule to the current list of rules used for scoring
   -  Load Original Rules - This loads the rules specified by Netwrix and can be used to understand the logic and slightly adjust things.
   -  Clear - Reverts back to the Netwrix specified scoring


Example

In this example the A-KRBTGT rule will be modified so that we get a score of 5 points if its password is over 42 days old and then we double it to 10 points when its password is older than a year but we will leave it in the Level 2 Maturity Assessment
[image]

[image (1)]

Running PingCastle using the custom rules

Here we will go through how to use PingCastle.exe with the custom rules.

Using the API

Running PingCastle.exe using the api options will automatically download the custom rules from the PingCastle Web Application.




`PingCastle.exe --HealthCheck --Server DC.domain.local --api-endpoint https://pc.domain.local --api-key blahblahblah`

This happens via the AgentController and the GetSettings API call.


Using the PingCastle.exe.config

For disconnected networks that cannot contact the PingCastle web application it is possible to use the PingCastle.exe.config to specify custom rules. You still specify them in the Web UI then click on download. You will then be presented with the XML configuration needed and you can copy that into the PingCastle.exe.config.



NOTE: You only really need to copy the <CustomRulesSettings> tag and overwrite any existing one in the PingCastle.exe.config. The <configSections> should already be in the file.


[image (2)]


You can see here how this may end up looking in an actual PingCastle.exe.config.

[image (3)]


Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation






--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/9/2025 9:36 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>; benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #441448 - ref:_00D7091pB._500Q000NrOqH:ref - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref


Another information :

I’ve tried to modify custom rules by using the values defined below :

namespace PingCastle.Healthcheck.Rules
{
[RuleModel(""P-DsHeuristicsDoListObject"", RiskRuleCategory.PrivilegedAccounts, RiskModelCategory.ACLCheck)]
[RuleComputation(RuleComputationType.TriggerOnPresence, 0)]
[RuleIntroducedIn(2, 7)]
[RuleMaturityLevel(2)]
[RuleMitreAttackMitigation(MitreAttackMitigation.ActiveDirectoryConfiguration)]
public class HeatlcheckRulePrivilegedDsHeuristicsDoListObject : RuleBase<HealthcheckData>
{
protected override int? AnalyzeDataNew(HealthcheckData healthcheckData)
{
if (healthcheckData.DSHeuristics != null && healthcheckData.DSHeuristics.Length >= 3 && healthcheckData.DSHeuristics.Substring(2, 1) != ""0"")
{
return 1;
}
return 0;
}
}
}

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : MALTAVERNE Julien
Envoyé : mercredi 9 avril 2025 15:29
À : 'Netwrix Support' <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>; LORACH Benoit <benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>>
Objet : RE: How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello

Thank you for contacting me.
You can find bellow the discussion in the Support Ticket 439303.

Best regards
Julien
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 9:42 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref


Emiliano

I don’t use --api-endpoint.
But I’ve checked my PingCastle version. It’s an auditor version. It seems that “custom rules” are only functional on pro version.

I try add a maturitylevel section but It’s not good….

<customRulesSettings>

    <CustomRules>

      <!--Risk P-DsHeuristicsDoListObject-->

      <CustomRule RiskId=""P-DsHeuristicsDoListObject"">

               <MaturityLevel MaturityLevel=”5”/>

      </CustomRule>

    </CustomRules>

  </customRulesSettings>

Regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : lundi 24 mars 2025 13:32
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : LORACH Benoit <benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>>
Objet : RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

Hi Julien,

The web UI is the web User Interface.

Then, let me ask you something, are you using the --api-endpoint ? If so, it could be overwriting the rule that you are trying to add and that's why is not being modified.
Please let me know that, so I can further investigate to assist you.

Thank you!
Regards,

Emiliano Kraiñuk
Technical Support Engineer
1-949-407-5125
____________________ __________
Cybersecurity That Works for You

Netwrix | 6160 Warren Parkway, Suite 100, Frisco, TX 75034
www.netwrix.com<http://www.netwrix.com>


--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 7:33 AM
To: techsupport@netwrix.com<mailto:techsupport@netwrix.com>
Cc: benoit.lorach@thalesgroup.com<mailto:benoit.lorach@thalesgroup.com>
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref


Hello Emiliano

I’ve tried to add the custom rule but the result is same.
Sorry but vould you explain me what mean Web UI ?

Best regards
Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>




Julien MALTAVERNE
Technical Directory Architect
TrustedCore Squad
TGS / DSI France
Mobile : 06 74 08 24 36
Kiss TrustedCore<https://kiss.service-now.com/esc?id=sc_cat_item&table=sc_cat_item&sys_id=f652eb3a9727b51027e8fe07f053af05>

[SITv4]

{ THALES GROUP LIMITED DISTRIBUTION }


De : Netwrix Support <techsupport@netwrix.com<mailto:techsupport@netwrix.com>>
Envoyé : mercredi 9 avril 2025 15:19
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com<mailto:julien.maltaverne@thalesgroup.com>>
Cc : kyle.vogley@netwrix.com<mailto:kyle.vogley@netwrix.com>
Objet : How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

Hello Maltaverne,

Thank you for contacting Netwrix Support. Please note that I will be assisting you with your query regarding custom rules in PingCastle. I will be getting back to you with updates on this. Meanwhile if you have any additional questions and concerns please feel free to add your comments.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation

ref:!00D70091pB.!500Qk0NrOqH:ref","RE: Netwrix Support Ticket #441448 -  - How to use custom rules on standalone pingcastle client    [ ref:!00D70091pB.!500Qk0NrOqH:ref ]","julien.maltaverne@thalesgroup.com","MALTAVERNE Julien","techsupport@netwrix.com","kyle.vogley@netwrix.com","","true","2025-04-28T06:28:50.000Z","true"
"02sQk00000ODcEXIA1","500Qk00000NrOqHIAV","2025-04-28T09:59:06.000Z","2025-04-28T09:59:06.000Z","Hello Julien!

I'm afraid there is no such feature in pipeline as of now. You can visit our community page for PingCastle for current and future update features. Here is the link for your reference: https://community.netwrix.com/c/products/pingcastle/27

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/28/2025 2:28 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref



Hello

 

Wahiba sent me a trial license so I’ve tried your solution.

That’s good for me. Is it possible to implement “custom rules” on auditor version in the future ?

 

Thank you

Best regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : vendredi 25 avril 2025 17:28
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello Julien!

I hope you are doing well. I just wanted to check if you were able to get your license sorted and tried the proposed solution?

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation


--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/23/2025 6:08 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref

 


Hello

 

I can’t test for the moment because my enterprise trial license is expired.
I’ve sent a mail to Wahiba to get another one.

 

Best regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : mercredi 23 avril 2025 11:39
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello Julien!

Hope you are doing alright. I just wanted to check with you if there is anything else that you need help with or should I go ahead and close this ticket?

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/22/2025 3:33 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref

 


Hello

 

Thank so you so much.
I’ll try this parameter.

 

Regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : lundi 14 avril 2025 13:25
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello Julien!

Did you try the following to exclude P-DsHeuristicsDoListObject:

<customRulesSettings>
    <CustomRules>
      <!--Risk P-DsHeuristicsDoListObject-->
      <CustomRule RiskId=""P-DsHeuristicsDoListObject"" />
      </CustomRule>
    </CustomRules>
  </customRulesSettings>

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/11/2025 7:52 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref

 


Hello

 

Thank you so much.

 

Best regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : vendredi 11 avril 2025 13:26
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Julien - thanks for your response. We are looking into the specifics of P-DsHeuristicsDoListObject parameters for you. I will get back to you with the updates soon. Thanks for your cooperation.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation



--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/10/2025 6:38 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com; benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref

 


Hello

 

Thank you for your support.
We only use PingCastle.exe.config

In my case I’m looking for P-DsHeuristicsDoListObject parameters to :


	Increase oradad maturity level to 5
	Otherwise remove this check


Can you help me to find the right custom rule for that ?

 

Best regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : jeudi 10 avril 2025 12:29
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : RE: Netwrix Support Ticket #441448 - - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello Julien!

Please refer to the following documentation and let me know if this helps:

Using rule customization in PingCastle Pro and Enterprise

Rule customization is a paid for feature and is easily configurable in the Professional and Enterprise editions. Customers can use this if they disagree with the rules we set and want to change them themselves but also serves as a useful way to understand the rule customizations visually.

To modify custom rules users can follow this process:

 - Login to the Web Application
 - Navigate to Configuration → Custom Rules 
 - Click on New Customization 
 - Select the Rule ID that needs to be customized
 - Click on  Next 
 - Use the Maturity Level dropdown to change the maturity level for a rule. 
   - This will affect the “Maturity Assessment” section of the report
 - Rule (Scoring) customization options
   -  Append Rule - This adds a new rule to the current list of rules used for scoring
   -  Load Original Rules - This loads the rules specified by Netwrix and can be used to understand the logic and slightly adjust things.
   -  Clear - Reverts back to the Netwrix specified scoring


Example

In this example the A-KRBTGT rule will be modified so that we get a score of 5 points if its password is over 42 days old and then we double it to 10 points when its password is older than a year but we will leave it in the Level 2 Maturity Assessment




Running PingCastle using the custom rules

Here we will go through how to use PingCastle.exe with the custom rules.

Using the API

Running PingCastle.exe using the api options will automatically download the custom rules from the PingCastle Web Application.
 



`PingCastle.exe --HealthCheck --Server DC.domain.local --api-endpoint https://pc.domain.local --api-key blahblahblah`



This happens via the AgentController and the GetSettings API call.


Using the PingCastle.exe.config

For disconnected networks that cannot contact the PingCastle web application it is possible to use the PingCastle.exe.config to specify custom rules. You still specify them in the Web UI then click on download. You will then be presented with the XML configuration needed and you can copy that into the PingCastle.exe.config.



NOTE: You only really need to copy the <CustomRulesSettings> tag and overwrite any existing one in the PingCastle.exe.config. The <configSections> should already be in the file.



 

You can see here how this may end up looking in an actual PingCastle.exe.config.





Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation






--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 4/9/2025 9:36 AM
To: techsupport@netwrix.com
Cc: kyle.vogley@netwrix.com; benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #441448 - ref:_00D7091pB._500Q000NrOqH:ref - How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]

ref:_00D7091pB._500Q000NrOqH:ref

 


Another information :

 

I’ve tried to modify custom rules by using the values defined below :

namespace PingCastle.Healthcheck.Rules
{
[RuleModel(""P-DsHeuristicsDoListObject"", RiskRuleCategory.PrivilegedAccounts, RiskModelCategory.ACLCheck)]
[RuleComputation(RuleComputationType.TriggerOnPresence, 0)]
[RuleIntroducedIn(2, 7)]
[RuleMaturityLevel(2)]
[RuleMitreAttackMitigation(MitreAttackMitigation.ActiveDirectoryConfiguration)]
public class HeatlcheckRulePrivilegedDsHeuristicsDoListObject : RuleBase<HealthcheckData>
{
protected override int? AnalyzeDataNew(HealthcheckData healthcheckData)
{
if (healthcheckData.DSHeuristics != null && healthcheckData.DSHeuristics.Length >= 3 && healthcheckData.DSHeuristics.Substring(2, 1) != ""0"")
{
return 1;
}
return 0;
}
}
}

 

Best regards


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : MALTAVERNE Julien
Envoyé : mercredi 9 avril 2025 15:29
À : 'Netwrix Support' <techsupport@netwrix.com>
Cc : kyle.vogley@netwrix.com; LORACH Benoit <benoit.lorach@thalesgroup.com>
Objet : RE: How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello

 

Thank you for contacting me.
You can find bellow the discussion in the Support Ticket 439303.

 

Best regards 

Julien

From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 9:42 AM
To: techsupport@netwrix.com
Cc: benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref

 

Emiliano

 

I don’t use --api-endpoint.

But I’ve checked my PingCastle version. It’s an auditor version. It seems that “custom rules” are only functional on pro version.

 

I try add a maturitylevel section but It’s not good….

 

<customRulesSettings>

 

    <CustomRules>

 

      <!--Risk P-DsHeuristicsDoListObject-->

 

      <CustomRule RiskId=""P-DsHeuristicsDoListObject"">

 

               <MaturityLevel MaturityLevel=”5”/>

 

      </CustomRule>

 

    </CustomRules>

 

  </customRulesSettings>

 

Regards

Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 

 

De : Netwrix Support <techsupport@netwrix.com>
Envoyé : lundi 24 mars 2025 13:32
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : LORACH Benoit <benoit.lorach@thalesgroup.com>
Objet : RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

 

Hi Julien,

The web UI is the web User Interface.

Then, let me ask you something, are you using the --api-endpoint ? If so, it could be overwriting the rule that you are trying to add and that's why is not being modified.
Please let me know that, so I can further investigate to assist you.

Thank you!
Regards,

Emiliano Kraiñuk
Technical Support Engineer
1-949-407-5125
____________________ __________
Cybersecurity That Works for You

Netwrix | 6160 Warren Parkway, Suite 100, Frisco, TX 75034
www.netwrix.com


--------------- Original Message ---------------
From: MALTAVERNE Julien [julien.maltaverne@thalesgroup.com]
Sent: 3/24/2025 7:33 AM
To: techsupport@netwrix.com
Cc: benoit.lorach@thalesgroup.com
Subject: RE: Netwrix Support Ticket #439303 - - Use CustomRules [ ref:!00D70091pB.!500Qk0N61Dt:ref ]

ref:_00D7091pB._500Q000N61Dt:ref

 

Hello Emiliano

 

I’ve tried to add the custom rule but the result is same.

Sorry but vould you explain me what mean Web UI ?

 

Best regards

Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 

 

 

 


Julien MALTAVERNE

Technical Directory Architect

TrustedCore Squad

TGS / DSI France

Mobile : 06 74 08 24 36

Kiss TrustedCore

 



 

{ THALES GROUP LIMITED DISTRIBUTION }

 


 



De : Netwrix Support <techsupport@netwrix.com>
Envoyé : mercredi 9 avril 2025 15:19
À : MALTAVERNE Julien <julien.maltaverne@thalesgroup.com>
Cc : kyle.vogley@netwrix.com
Objet : How to use custom rules on standalone pingcastle client [ ref:!00D70091pB.!500Qk0NrOqH:ref ]



 

Hello Maltaverne,

Thank you for contacting Netwrix Support. Please note that I will be assisting you with your query regarding custom rules in PingCastle. I will be getting back to you with updates on this. Meanwhile if you have any additional questions and concerns please feel free to add your comments.

Regards,

Shaheryar Ali
Technical Support Engineer
Netwrix Corportation

ref:!00D70091pB.!500Qk0NrOqH:ref","RE: Netwrix Support Ticket #441448 -  - How to use custom rules on standalone pingcastle client    [ ref:!00D70091pB.!500Qk0NrOqH:ref ]","techsupport@netwrix.com","Netwrix Support","julien.maltaverne@thalesgroup.com","kyle.vogley@netwrix.com","shaheryar.ali.tahir@netwrix.com","true","2025-04-28T09:59:05.000Z","true"
