## Ticket Metadata
- **Ticket ID:** 500Qk00000C1cSaIAJ
- **Case Number:** 412317
- **Status:** Closed - Resolved
- **Account/Company:** Hydro Group Norway
- **Contact Name:** Ramesh R
- **Product:** Netwrix Enterprise Auditor
- **Component:** StealthAUDIT General
- **Feature:** Custom Reports
- **Version:** 11.6

## Problem Description
The customer reported a mismatch between the automated mail and activity scan reports generated by the Netwrix system.

## Environment Details
- The issue occurred within the Netwrix Enterprise Auditor platform, specifically involving the StealthAUDIT component.

## Troubleshooting Steps
1. **Initial Inquiry:** The support engineer requested clarification on what specifically did not match in the reports and asked for screenshots.
2. **Manual Verification:** The customer manually checked the activity scan sites and identified discrepancies, providing error sites and an automated activity scan report.
3. **Report Analysis:** The support engineer identified that the current report was using the `Bulk_Import_Activity` table, which did not include error messages for FSAA/FSAC System Scans and Bulk Import jobs.
4. **Custom Job Creation:** A custom job (`JS_JobMessages`) was created to gather job messages from the `SA_Messages` table, which was necessary for reporting error messages.
5. **Job Execution:** The customer was instructed to execute the custom job and check the `FS_JobMessages` table for output.
6. **Host Configuration:** The customer was advised to ensure that the correct host lists were assigned to the job and to disable the "Skip hosts that do not respond to PING" option.
7. **Follow-up:** The support engineer followed up to confirm if the job was executed successfully and if the output was satisfactory.

## Root Cause
The mismatch was primarily due to the use of the incorrect data source (`Bulk_Import_Activity` table) for generating reports, which did not capture the necessary error messages from the relevant scans.

## Solution
The issue was resolved by:
- Creating a custom job that utilized the `SA_Messages` table to accurately report error messages.
- Ensuring that the job was executed without any active scans running concurrently, which could interfere with data collection.

## Notes
- It is crucial to run the custom job only when there are no active scans in the "Running Instances" tab to avoid data collection issues.
- The job should not require any SQL queries to be specified, as it is designed to gather messages directly from the `SA_Messages` table.