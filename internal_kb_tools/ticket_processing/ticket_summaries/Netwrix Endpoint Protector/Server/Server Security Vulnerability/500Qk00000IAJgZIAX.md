## Ticket Metadata
- **Ticket ID:** 500Qk00000IAJgZIAX
- **Case Number:** 426698
- **Status:** Closed - Resolved
- **Account/Company:** addventures
- **Contact Name:** Mark Laslo
- **Product:** Netwrix Endpoint Protector
- **Component:** Server
- **Feature:** Server Security Vulnerability
- **Version:** 5.9.4.0

## Problem Description
The customer reported that their EPP server was vulnerable to clickjacking, as indicated by their vulnerability scanner. They requested assistance to apply the necessary patch to mitigate this vulnerability.

## Environment Details
- The EPP server is hosted on a local VM.
- The server is running version 5.9.4.0 of Netwrix Endpoint Protector.

## Troubleshooting Steps
1. Initial communication confirmed the customer's report of a clickjacking vulnerability.
2. Requested a screenshot of the vulnerability scan results from the customer.
3. Reviewed the previous patch history and confirmed that the last patch applied was for a different vulnerability (client exploit).
4. Identified the need to add a missing directive in the Nginx configuration to address the clickjacking vulnerability.
5. Scheduled a remote session to apply the necessary changes to the Nginx configuration.
6. During the session, SSH access was confirmed, and the following line was added to the Nginx configuration file located at `/etc/nginx/sites-enabled/epp.nginx.conf`:
   ```nginx
   add_header Content-Security-Policy "frame-ancestors 'self'; default-src 'self' 'unsafe-eval' 'unsafe-inline'; worker-src blob:";
   ```
7. Followed up with the customer after the changes were made to ensure the issue was resolved.

## Root Cause
The clickjacking vulnerability was due to the absence of the appropriate Content Security Policy (CSP) directive in the Nginx configuration, which is necessary to prevent the server from being embedded in iframes by unauthorized sources.

## Solution
The issue was resolved by adding the required CSP directive to the Nginx configuration file. After applying the changes, the customer was advised to run another vulnerability scan to confirm that the clickjacking vulnerability had been mitigated.

## Notes
- It is recommended to always take a snapshot of the VM before making configuration changes to ensure that a rollback option is available in case of any issues.
- Customers should be encouraged to regularly review their vulnerability scan results and maintain updated configurations to prevent similar vulnerabilities in the future.