## Ticket Metadata
- **Ticket ID:** 500Qk00000MNAQEIA5
- **Case Number:** 437239
- **Status:** Closed - Resolved
- **Account/Company:** Neoway
- **Contact Name:** Lucas Cavalcante
- **Product:** Netwrix Endpoint Protector
- **Component:** Server
- **Feature:** Server Security Vulnerability
- **Version:** Not specified

## Problem Description
The customer requested the implementation of specific HTTP headers, including modifications to the `Strict-Transport-Security` and `Content-Security-Policy` headers. They required the `Content-Security-Policy` to be set to `Content-Security-Policy-Report-Only` to avoid interference with the EPP UI, and they insisted on including `frame-ancestors 'none'` in this policy.

## Environment Details
- The issue was related to the configuration of HTTP headers in the Netwrix Endpoint Protector's Nginx configuration.

## Troubleshooting Steps
1. **Initial Customer Request:** Received a request for HTTP header implementation on 2/27/2025.
2. **R&D Escalation:** Raised an escalation ticket to R&D on 2/27/2025 to determine the feasibility of the requested changes.
3. **Status Updates:** Regular follow-ups were conducted with R&D and the customer to keep them informed of progress.
4. **Remote Session:** Scheduled a remote session for 3/26/2025 to implement the R&D fix.
5. **Implementation:** Joined the remote session on 3/26/2025 and implemented the changes to the Nginx configuration.
6. **Testing:** Instructed the customer to test the changes and report any issues.

## Root Cause
The initial configuration of the HTTP headers did not meet the customer's security requirements, particularly regarding the `Content-Security-Policy` and `Strict-Transport-Security` settings. The need for a non-intrusive policy that would not disrupt the EPP UI was critical for the customer.

## Solution
The following changes were made to the Nginx configuration file `/etc/nginx/sites-enabled/epp.nginx.conf`:
```nginx
add_header Strict-Transport-Security "max-age=31536000; includeSubdomains; preload";
add_header Content-Security-Policy-Report-Only "default-src 'self' 'unsafe-eval' 'unsafe-inline'; frame-ancestors 'self'; worker-src blob;";
```
- The `Content-Security-Policy` was changed to `Content-Security-Policy-Report-Only` to allow monitoring of policy violations without enforcing them immediately.
- The `frame-ancestors` directive was set to `'self'` to prevent blocking of resources while still maintaining security.

## Notes
- The customer confirmed that the implemented changes resolved their issues and requested the case to be closed.
- Future implementations of similar header changes should consider the potential impact on UI functionality and ensure that customer requirements are clearly understood before proceeding.